(this["webpackJsonpmeasure-app"]=this["webpackJsonpmeasure-app"]||[]).push([[0],{19:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},26:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(9),l=n.n(o),c=(n(19),n(10)),a=(n(23),n(8)),u=n(5),s=n(13),d=n(7);function f(t){if(!t.length)return"";var e=t.reduce((function(t,e,n,r){var i=Object(u.a)(e,2),o=i[0],l=i[1],c=Object(u.a)(r[(n+1)%r.length],2),a=c[0],s=c[1];return t.push(o,l,(o+a)/2,(l+s)/2),t}),["M"].concat(Object(d.a)(t[0]),["Q"]));return e.push("Z"),e.join(" ")}var p="http://www.w3.org/2000/svg",v=0;function h(t,e){var n=e.x1,r=e.x2,i=e.y1,o=e.y2,l=e.strokeWidth,c=e.stroke,a=void 0===c?"#000":c;t.setAttribute("x1",n.toString()),t.setAttribute("y1",i.toString()),t.setAttribute("x2",r.toString()),t.setAttribute("y2",o.toString()),t.setAttribute("stroke",a),l&&t.setAttribute("stroke-width",l.toString())}function g(t,e){var n=e.x,r=e.y,i=e.width,o=e.height,l=e.strokeWidth,c=e.stroke,a=e.fill;t.setAttribute("x",n.toString()),t.setAttribute("y",r.toString()),t.setAttribute("width",i.toString()),t.setAttribute("height",o.toString()),a&&t.setAttribute("fill",a),c&&t.setAttribute("stroke",c),l&&t.setAttribute("stroke-width",l.toString())}function b(t,e){var n=e.x,r=e.y,i=e.rx,o=e.ry,l=e.strokeWidth,c=e.stroke,a=e.fill;t.setAttribute("cx",n.toString()),t.setAttribute("cy",r.toString()),t.setAttribute("rx",i.toString()),t.setAttribute("ry",o.toString()),a&&t.setAttribute("fill",a),c&&t.setAttribute("stroke",c),l&&t.setAttribute("stroke-width",l.toString())}function w(t,e,n,r){var i=e?null===t||void 0===t?void 0:t.getElementById(e):void 0,o=null!==e&&void 0!==e?e:"".concat(v++);if(!i){(i=document.createElementNS(p,n)).setAttribute("id",o);var l=r?null===t||void 0===t?void 0:t.getElementById(r):t;null===l||void 0===l||l.appendChild(i)}return{element:i,id:o}}function y(){var t=Object(r.useState)({scale:2,selectedTool:"wall",pointerDown:!1,stylusMode:!0,magneticMode:!0,wallAlignmentMode:!0,plan:{walls:[]}}),e=Object(u.a)(t,2),n=e[0],i=e[1],o=Object(r.useCallback)((function(t){return i((function(e){return Object(a.a)(Object(a.a)({},e),t)}))}),[]),l=Object(r.useRef)(null),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Object(r.useRef)(null);return Object(r.useEffect)((function(){var n=e.current,r=null===n||void 0===n?void 0:n.parentElement;if(n&&r){var i=r.getBoundingClientRect(),o=i.width,l=i.height;n.setAttribute("viewBox","0 0 ".concat(o*t," ").concat(l*t)),n.setAttribute("version","1.1"),n.setAttribute("xmlns",p),n.setAttribute("width","".concat(o*t)),n.setAttribute("height","".concat(l*t))}}),[t,e]),{svgRef:e,drawing:{drawLine:function(t){var n=w(e.current,t.id,"line",t.groupId),r=n.element,i=n.id;return h(r,t),i},drawCircle:function(t){var n=w(e.current,t.id,"ellipse",t.groupId),r=n.element,i=n.id;return b(r,t),i},drawRect:function(t){var n=w(e.current,t.id,"rect",t.groupId),r=n.element,i=n.id;return g(r,t),i},createGroup:function(t,n){return w(e.current,t,"g",n).id},removeElement:function(t){var n,r=null===(n=e.current)||void 0===n?void 0:n.getElementById(t);null===r||void 0===r||r.remove()},drawPath:function(t){var n=t.id,r=t.points,i=t.groupId,o=w(e.current,n,"path",i),l=o.element,c=o.id;return l.setAttribute("d",f(Object(s.a)(r,{size:t.strokeWidth,smoothing:.5,thinning:.5}))),c}}}}(n.scale),d=c.svgRef;return{drawing:c.drawing,drawingRef:d,interactiveRef:l,globalState:n,setGlobalState:i,updateGlobalState:o}}var x,m=i.a.createContext(null),j=function(){var t=i.a.useContext(m);if(null===t)throw new Error("useGlobalContext must be used within an GlobalContext.Provider");return t},O=["title","titleId"];function E(){return(E=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function k(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function I(t,e){var n=t.title,i=t.titleId,o=k(t,O);return r.createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,x||(x=r.createElement("path",{d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})))}var S=r.forwardRef(I);n.p;function L(t,e,n,r,i,o,l){t.drawRect({id:e,groupId:n,x:r-o/2,y:i-o/2,width:o,height:o,fill:l})}function M(t,e,n,r,i,o,l,c){t.drawCircle({id:e,groupId:n,x:r,y:i,rx:o,ry:o,fill:l,stroke:c})}var A=15,C=function(t){return"w".concat(t.id)};function P(t,e){var n=C(e);L(t,"w".concat(e.id,"s"),n,e.p1.x,e.p1.y,10,"green")}function R(t,e){var n=t.createGroup(C(e),"walls");M(t,"w".concat(e.id,"c1"),n,e.p1.x,e.p1.y,A,"none","#000"),M(t,"w".concat(e.id,"c2"),n,e.p2.x,e.p2.y,A,"none","#000"),function(t,e,n,r,i,o,l){t.drawLine({id:e,groupId:n,x1:r,y1:i,x2:o,y2:l})}(t,"w".concat(e.id,"l"),n,e.p1.x,e.p1.y,e.p2.x,e.p2.y),P(t,e),function(t,e){var n=C(e);L(t,"w".concat(e.id,"e"),n,e.p2.x,e.p2.y,10,"red")}(t,e)}n(24);var V=n(1),H=[],T=function(t){var e=t.drawing;return Object(V.jsx)("div",{className:"historyPanel",children:Object(V.jsx)("div",{className:"historyPanelItem",onClick:function(){return function(){var t=H.pop();if(t)switch(t.tool){case"wall":t.data.forEach((function(t){e.removeElement(C(t))}));break;case"cursor":t.data.forEach((function(t){R(e,t)}));break;case"pencil":case"eraser":e.removeElement(t.data)}}()},children:Object(V.jsx)(S,{})})})},D=(n(26),function(){var t=j(),e=t.globalState,n=e.stylusMode,r=e.magneticMode,i=e.wallAlignmentMode,o=t.updateGlobalState;return Object(V.jsxs)("div",{className:"settingsList",children:[Object(V.jsx)("div",{children:Object(V.jsxs)("label",{children:[Object(V.jsx)("input",{type:"checkbox",checked:null!==n&&void 0!==n&&n,onChange:function(t){return o({stylusMode:t.target.checked})}}),"\u0420\u0435\u0436\u0438\u043c \u0441\u0442\u0438\u043b\u0443\u0441\u0430"]})}),Object(V.jsx)("div",{children:Object(V.jsxs)("label",{children:[Object(V.jsx)("input",{type:"checkbox",checked:null!==i&&void 0!==i&&i,onChange:function(t){return o({wallAlignmentMode:t.target.checked})}}),"\u0420\u043e\u0432\u043d\u044b\u0435 \u0441\u0442\u0435\u043d\u044b"]})}),Object(V.jsx)("div",{children:Object(V.jsxs)("label",{children:[Object(V.jsx)("input",{type:"checkbox",checked:null!==r&&void 0!==r&&r,onChange:function(t){return o({magneticMode:t.target.checked})}}),"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u043a \u0441\u0442\u0435\u043d\u0430\u043c"]})}),Object(V.jsx)("a",{href:"https://perfect-freehand-example.vercel.app/",target:"_blank",rel:"noreferrer",style:{marginLeft:25},children:"Perfect freehand"})]})});function X(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function G(t,e,n,r){function i(t){return{id:1,x:t.pageX,y:t.pageY,type:"mouse",buttons:t.buttons,changedTouches:[{identifier:1,pageX:t.pageX,pageY:t.pageY}]}}var o=function(t){return e(i(t))},l=function(t){return n(i(t))},c=function(t){return r(i(t))};function a(t){var e=t.changedTouches[0];return{id:e.identifier,x:e.pageX,y:e.pageY,touches:Array.from(t.touches),changedTouches:Array.from(t.changedTouches),type:"stylus"===e.touchType?"stylus":"touch"}}var u=function(t){return e(a(t))},s=function(t){return n(a(t))},d=function(t){return r(a(t))};return t.addEventListener("mousedown",o),t.addEventListener("mousemove",l),t.addEventListener("mouseup",c),t.addEventListener("touchstart",u),t.addEventListener("touchmove",s),t.addEventListener("touchend",d),function(){t.removeEventListener("mousedown",o),t.removeEventListener("mousemove",l),t.removeEventListener("mouseup",c),t.removeEventListener("touchstart",u),t.removeEventListener("touchmove",s),t.removeEventListener("touchend",d)}}var B,N=function(){var t=j(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,l=i.scale,c=i.stylusMode,a=i.magneticMode,u=i.selectedTool,s=i.plan;return Object(r.useEffect)((function(){if(e.current&&"cursor"===u){return G(e.current,(function(t){var e;c&&"touch"===t.type||(o({pointerDown:!0}),null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,n=t.pageX*l,r=t.pageY*l;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return X(t,{x:n,y:r})<=A})).forEach((function(t){t.editId=e})),H.push({tool:"cursor",data:s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).map((function(t){return{id:t.id,p1:{x:t.p1.x,y:t.p1.y},p2:{x:t.p2.x,y:t.p2.y}}}))})})))}),(function(t){var e;("mouse"!==t.type||t.buttons)&&(null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,r=t.pageX*l,i=t.pageY*l;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){t.x=r,t.y=i})),s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){return R(n,t)}))})))}),(function(t){var e,r;null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){if(a){var e=s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(e){return e!==t&&e.x!==t.x&&e.y!==t.y})).find((function(e){return X(e,t)<=A}));e&&(t.x=e.x,t.y=e.y)}})),s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){t.p1.editId=void 0,t.p2.editId=void 0,R(n,t)}))})),0===(null===(r=t.touches)||void 0===r?void 0:r.length)&&o({pointerDown:!1})}))}}),[e.current,l,c,a,u]),null},Y=["pencil","eraser"],W=function(){var t=j(),e=t.drawing,n=t.interactiveRef,i=t.globalState,o=t.updateGlobalState,l=i.scale,c=i.stylusMode,a=i.magneticMode,u=i.selectedTool;return Object(r.useEffect)((function(){if(n.current&&Y.includes(u)){var t,r=[];return G(n.current,(function(n){var i,a,s;if((!c||"touch"!==n.type)&&!("touch"===n.type&&n.touches.length>1)){o({pointerDown:!0});var d=n.touches&&n.touches[0],f=(null!==(i=null===d||void 0===d?void 0:d.pageX)&&void 0!==i?i:n.x)*l,p=(null!==(a=null===d||void 0===d?void 0:d.pageY)&&void 0!==a?a:n.y)*l;r.push({x:f,y:p,pressure:null!==(s=null===d||void 0===d?void 0:d.force)&&void 0!==s?s:.5}),"pencil"===u?(t=e.drawPath({points:r,stroke:"#000",strokeWidth:1.5*l,fill:"none",groupId:"pen"}),H.push({tool:"pencil",data:t})):(t=e.drawPath({points:r,stroke:"#fff",groupId:"pen"}),H.push({tool:"eraser",data:t}))}}),(function(n){var i,o,a;if((!c||"touch"!==n.type)&&("mouse"!==n.type||n.buttons)){var u=n.touches&&n.touches[0],s=(null!==(i=null===u||void 0===u?void 0:u.pageX)&&void 0!==i?i:n.x)*l,d=(null!==(o=null===u||void 0===u?void 0:u.pageY)&&void 0!==o?o:n.y)*l;r.push({x:s,y:d,pressure:null!==(a=null===u||void 0===u?void 0:u.force)&&void 0!==a?a:.5}),e.drawPath({id:t,points:r,strokeWidth:1.5*l})}}),(function(t){r=[],t.touches&&0!==t.touches.length||o({pointerDown:!1})}))}}),[n.current,l,c,a,u]),null},Z=n(14),z=["title","titleId"];function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function J(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function q(t,e){var n=t.title,i=t.titleId,o=J(t,z);return r.createElement("svg",F({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,B||(B=r.createElement("path",{d:"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})))}var Q,U=r.forwardRef(q),_=(n.p,["title","titleId"]);function K(){return(K=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function $(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function tt(t,e){var n=t.title,i=t.titleId,o=$(t,_);return r.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,Q||(Q=r.createElement("path",{d:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"})))}var et,nt=r.forwardRef(tt),rt=(n.p,["title","titleId"]);function it(){return(it=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function ot(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function lt(t,e){var n=t.title,i=t.titleId,o=ot(t,rt);return r.createElement("svg",it({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,et||(et=r.createElement("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})))}var ct,at=r.forwardRef(lt),ut=(n.p,["title","titleId"]);function st(){return(st=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function dt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function ft(t,e){var n=t.title,i=t.titleId,o=dt(t,ut);return r.createElement("svg",st({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,ct||(ct=r.createElement("path",{d:"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z"})))}var pt,vt=r.forwardRef(ft),ht=(n.p,["title","titleId"]);function gt(){return(gt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function bt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function wt(t,e){var n=t.title,i=t.titleId,o=bt(t,ht);return r.createElement("svg",gt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,pt||(pt=r.createElement("path",{d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})))}var yt=r.forwardRef(wt),xt=(n.p,n(27),function(){var t=j(),e=t.drawingRef,n=t.globalState.selectedTool,r=t.updateGlobalState,i=function(t){var e=t.type,i=t.name,o=t.icon;return Object(V.jsx)("div",{onClick:function(){r({selectedTool:e})},className:Object(Z.a)("toolboxItem",n===e&&"toolboxSelectedItem"),children:null!==o&&void 0!==o?o:i})};return Object(V.jsxs)("div",{className:"toolboxContainer",children:[Object(V.jsx)(i,{type:"wall",name:"\u0421\u0442\u0435\u043d\u0430",icon:Object(V.jsx)(vt,{})}),Object(V.jsx)(i,{type:"cursor",name:"\u041a\u0443\u0440\u0441\u043e\u0440",icon:Object(V.jsx)(U,{})}),Object(V.jsx)(i,{type:"pencil",name:"\u041a\u0430\u0440\u0430\u043d\u0434\u0430\u0448",icon:Object(V.jsx)(at,{})}),Object(V.jsx)(i,{type:"eraser",name:"\u041b\u0430\u0441\u0442\u0438\u043a",icon:Object(V.jsx)(nt,{})}),Object(V.jsx)("div",{className:"toolboxItem",onClick:function(){return function(t){var e=t.cloneNode(!0),n=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),r=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",n);r.replaceChild(e,r.documentElement);var i=(new XMLSerializer).serializeToString(r),o=document.createElement("a");o.href="data:image/svg+xml; charset=utf8, "+encodeURIComponent(i.replace(/></g,">\n\r<")),o.download="Plan ".concat((new Date).toLocaleDateString(),".svg"),document.body.appendChild(o),o.click(),o.remove()}(e.current)},children:Object(V.jsx)(yt,{})})]})}),mt=0,jt=function(){var t=j(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,l=i.scale,c=i.stylusMode,a=i.magneticMode,u=i.wallAlignmentMode,s=i.selectedTool,d=i.plan;return Object(r.useEffect)((function(){if(e.current&&"wall"===s){return G(e.current,(function(t){console.log("wall onStart",t);var e=t.x*l,r=t.y*l;if(!c||"touch"!==t.type)if("touch"===t.type&&t.touches.length>1)!function(t){var e=d.walls.findIndex((function(e){return e.editId===t}));if(e>=0){var r=d.walls.splice(e,1);n.removeElement(C(r[0]))}}(t.id);else{o({pointerDown:!0});var i={id:mt++,editId:t.id,p1:{x:e,y:r},p2:{x:e,y:r}};if(a){var u=d.walls.flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return X(t,i.p1)<=A}));u&&(i.p1.x=u.x,i.p1.y=u.y,i.p2.x=u.x,i.p2.y=u.y)}d.walls.push(i),P(n,i)}}),(function(t){if("mouse"!==t.type||t.buttons){var e=t.x*l,r=t.y*l,i=d.walls.find((function(e){return e.editId===t.id}));i&&(i.p2.x=e,i.p2.y=r,u&&("horizontal"===function(t){var e=t.p1,n=t.p2,r=n.x-e.x,i=n.y-e.y;return Math.abs(r)>Math.abs(i)?"horizontal":"vertical"}({p1:i.p1,p2:{x:e,y:r}})?i.p2.y=i.p1.y:i.p2.x=i.p1.x),R(n,i))}}),(function(t){console.log("wall onEnd",t);var e=t.id,r=t.touches,i=d.walls.find((function(t){return t.editId===e}));if(i){if(i.editId=void 0,a){var l=d.walls.filter((function(t){return t!==i})).flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return X(t,i.p2)<=A}));l&&(i.p2.x=l.x,i.p2.y=l.y)}R(n,i),H.push({tool:"wall",data:[i]})}0===(null===r||void 0===r?void 0:r.length)&&o({pointerDown:!1})}))}}),[e.current,c,a,u,s]),null};var Ot=function(){var t=y(),e=t.drawing,n=t.drawingRef,i=t.interactiveRef,o=t.globalState.pointerDown;return Object(r.useEffect)((function(){var t=function(t){o&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),function(){document.removeEventListener("touchmove",t)}}),[o]),Object(V.jsx)(m.Provider,{value:t,children:Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(c.a,{children:Object(V.jsx)("title",{children:"Measure App"})}),Object(V.jsxs)("main",{children:[Object(V.jsx)(jt,{}),Object(V.jsx)(N,{}),Object(V.jsx)(W,{}),Object(V.jsx)("div",{ref:i,className:"paper main",children:Object(V.jsxs)("svg",{ref:n,style:{width:"100%",height:"100%"},children:[Object(V.jsx)("g",{id:"pen"}),Object(V.jsx)("g",{id:"walls"})]})}),Object(V.jsx)(xt,{}),Object(V.jsx)(D,{}),Object(V.jsx)(T,{drawing:e})]})]})})},Et=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,l=e.getTTFB;n(t),r(t),i(t),o(t),l(t)}))};l.a.render(Object(V.jsx)(i.a.StrictMode,{children:Object(V.jsx)(Ot,{})}),document.getElementById("root")),Et()}},[[28,1,2]]]);
//# sourceMappingURL=main.1bb74579.chunk.js.map