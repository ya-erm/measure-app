(this["webpackJsonpmeasure-app"]=this["webpackJsonpmeasure-app"]||[]).push([[0],{20:function(t,e,n){},24:function(t,e,n){},25:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(11),l=n.n(o),u=(n(20),n(12)),a=(n(24),n(10)),c=n(7),s=n(9),d=n(3),f=n(4),h=function(){function t(e,n){Object(d.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=n}return Object(f.a)(t,[{key:"toVector",value:function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)),e=Math.atan2(this.y,this.x);return new w(t,e)}},{key:"scale",value:function(e){return new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"eql",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"clone",value:function(){return new t(this.x,this.y)}}]),t}(),v="M",p="L",y="C",g="Z",b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(d.a)(this,t),this.type=void 0,this.value=void 0,this.value=n,this.type=e}return Object(f.a)(t,[{key:"cr",get:function(){if(("C"===this.type||"c"===this.type)&&6===this.value.length){var t=this.value.slice(2,4),e=Object(c.a)(t,2),n=e[0],r=e[1];return new h(n,r)}},set:function(t){t&&("C"!==this.type&&"c"!==this.type||6!==this.value.length||(this.value.splice(2,1,t.x),this.value.splice(3,1,t.y)))}},{key:"cl",get:function(){if(("C"===this.type||"c"===this.type)&&6===this.value.length){var t=this.value.slice(0,2),e=Object(c.a)(t,2),n=e[0],r=e[1];return new h(n,r)}},set:function(t){t&&("C"!==this.type&&"c"!==this.type||6!==this.value.length||(this.value.splice(0,1,t.x),this.value.splice(1,1,t.y)))}},{key:"point",get:function(){var t=this.value.slice(this.value.length-2);return 2===t.length?new h(t[0],t[1]):void 0},set:function(t){t&&(this.value.splice(this.value.length-2,1,t.x),this.value.splice(this.value.length-1,1,t.y))}},{key:"toString",value:function(){return this.type===g?g:"".concat(this.type," ").concat(this.value.map((function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return+t.toFixed(e)}(t)})).join(" "))}},{key:"scale",value:function(e){return new t(this.type,this.value.map((function(t){return t*e})))}},{key:"clone",value:function(){return new t(this.type,this.value.slice())}}]),t}(),w=function(){function t(e,n){Object(d.a)(this,t),this.angle=void 0,this.value=void 0,this.value=e,this.angle=n}return Object(f.a)(t,[{key:"toPoint",value:function(){var t=Math.cos(this.angle)*this.value,e=Math.sin(this.angle)*this.value;return new h(t,e)}},{key:"scale",value:function(e){return new t(this.value*e,this.angle)}}]),t}(),x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ratio;Object(d.a)(this,t),this.ratio=void 0,this.ratio=null!==n&&void 0!==n?n:.2}return Object(f.a)(t,[{key:"_controlPoint",value:function(t,e,n){var r=new h(t.x,t.y),i=new h(e.x,e.y),o=new h(n.x,n.y).sub(r).toVector().scale(this.ratio).toPoint(),l=i.add(o);return[l.x,l.y]}},{key:"bezierCurve",value:function(t,e,n,r){var i=[].concat(Object(s.a)(this._controlPoint(t,e,n)),Object(s.a)(this._controlPoint(r,n,e)),[n.x,n.y]);return new b(y,i)}},{key:"lineCommands",value:function(t){return t.map((function(t,e){return new b(0===e?v:p,[t.x,t.y])}))}},{key:"bezierCurveCommands",value:function(t){var e=[];if(t.length<3)return this.lineCommands(t);for(var n=0;n<t.length;n+=1)0!==n?e.push(this.bezierCurve(t[n-2<0?0:n-2],t[n-1],t[n],n<t.length-1?t[n+1]:t[n])):e.push(new b(v,[t[n].x,t[n].y]));return e}}]),t}(),j="http://www.w3.org/2000/svg",m=0;function O(t,e,n,r){var i=e?null===t||void 0===t?void 0:t.getElementById(e):void 0,o=null!==e&&void 0!==e?e:"".concat(m++);if(!i){(i=document.createElementNS(j,n)).setAttribute("id",o);var l=r?null===t||void 0===t?void 0:t.getElementById(r):t;null===l||void 0===l||l.appendChild(i)}return{element:i,id:o}}function k(){var t=Object(r.useState)({scale:1,selectedTool:"wall",pointerDown:!1,stylusMode:!0,magneticMode:!0,wallAlignmentMode:!0,plan:{walls:[]}}),e=Object(c.a)(t,2),n=e[0],i=e[1],o=Object(r.useCallback)((function(t){return i((function(e){return Object(a.a)(Object(a.a)({},e),t)}))}),[]),l=Object(r.useRef)(null),u=function(){var t=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=t.current,n=null===e||void 0===e?void 0:e.parentElement;if(e&&n){var r=n.getBoundingClientRect(),i=r.width,o=r.height;e.setAttribute("viewBox","0 0 ".concat(i," ").concat(o)),e.setAttribute("version","1.1"),e.setAttribute("xmlns",j),e.setAttribute("width",i.toString()),e.setAttribute("height",o.toString())}}),[t]),{svgRef:t,drawing:{drawLine:function(e){var n=O(t.current,e.id,"line",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x1,r=e.x2,i=e.y1,o=e.y2,l=e.strokeWidth,u=e.stroke,a=void 0===u?"#000":u;t.setAttribute("x1",n.toString()),t.setAttribute("y1",i.toString()),t.setAttribute("x2",r.toString()),t.setAttribute("y2",o.toString()),t.setAttribute("stroke",a),l&&t.setAttribute("stroke-width",l.toString())}(r,e),i},drawCircle:function(e){var n=O(t.current,e.id,"ellipse",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x,r=e.y,i=e.rx,o=e.ry,l=e.strokeWidth,u=e.stroke,a=e.fill;t.setAttribute("cx",n.toString()),t.setAttribute("cy",r.toString()),t.setAttribute("rx",i.toString()),t.setAttribute("ry",o.toString()),a&&t.setAttribute("fill",a),u&&t.setAttribute("stroke",u),l&&t.setAttribute("stroke-width",l.toString())}(r,e),i},drawRect:function(e){var n=O(t.current,e.id,"rect",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x,r=e.y,i=e.width,o=e.height,l=e.strokeWidth,u=e.stroke,a=e.fill;t.setAttribute("x",n.toString()),t.setAttribute("y",r.toString()),t.setAttribute("width",i.toString()),t.setAttribute("height",o.toString()),a&&t.setAttribute("fill",a),u&&t.setAttribute("stroke",u),l&&t.setAttribute("stroke-width",l.toString())}(r,e),i},createGroup:function(e,n){return O(t.current,e,"g",n).id},removeElement:function(e){var n,r=null===(n=t.current)||void 0===n?void 0:n.getElementById(e);null===r||void 0===r||r.remove()},drawPath:function(e){var n=e.id,r=e.points,i=e.groupId,o=O(t.current,n,"path",i),l=o.element,u=o.id;!function(t,e){var n=e.strokeWidth,r=e.stroke,i=e.fill,o=e.strokeLinecap,l=e.close,u=void 0!==l&&l;i&&t.setAttribute("fill",i),r&&t.setAttribute("stroke",r),n&&t.setAttribute("stroke-width",n.toString()),o&&t.setAttribute("stroke-linecap",o),t.setAttribute("close","".concat(u))}(l,e);var a=(new x).bezierCurveCommands(r);return l.setAttribute("d",a.map((function(t){return t.toString()})).join(" ")),u}}}}(),s=u.svgRef;return{drawing:u.drawing,drawingRef:s,interactiveRef:l,globalState:n,setGlobalState:i,updateGlobalState:o}}var E,S=i.a.createContext(null),M=function(){var t=i.a.useContext(S);if(null===t)throw new Error("useGlobalContext must be used within an GlobalContext.Provider");return t},C=["title","titleId"];function I(){return(I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function L(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function A(t,e){var n=t.title,i=t.titleId,o=L(t,C);return r.createElement("svg",I({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,E||(E=r.createElement("path",{d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})))}var P=r.forwardRef(A);n.p;function R(t,e,n,r,i,o,l){t.drawRect({id:e,groupId:n,x:r-o/2,y:i-o/2,width:o,height:o,fill:l})}function V(t,e,n,r,i,o,l,u){t.drawCircle({id:e,groupId:n,x:r,y:i,rx:o,ry:o,fill:l,stroke:u})}var H=15,T=function(t){return"w".concat(t.id)};function X(t,e){var n=T(e);R(t,"w".concat(e.id,"s"),n,e.p1.x,e.p1.y,10,"green")}function B(t,e){var n=t.createGroup(T(e),"walls");V(t,"w".concat(e.id,"c1"),n,e.p1.x,e.p1.y,H,"none","#000"),V(t,"w".concat(e.id,"c2"),n,e.p2.x,e.p2.y,H,"none","#000"),function(t,e,n,r,i,o,l){t.drawLine({id:e,groupId:n,x1:r,y1:i,x2:o,y2:l})}(t,"w".concat(e.id,"l"),n,e.p1.x,e.p1.y,e.p2.x,e.p2.y),X(t,e),function(t,e){var n=T(e);R(t,"w".concat(e.id,"e"),n,e.p2.x,e.p2.y,10,"red")}(t,e)}n(25);var G=n(1),D=[],W=function(t){var e=t.drawing;return Object(G.jsx)("div",{className:"historyPanel",children:Object(G.jsx)("div",{className:"historyPanelItem",onClick:function(){return function(){var t=D.pop();if(t)switch(t.tool){case"wall":t.data.forEach((function(t){e.removeElement(T(t))}));break;case"cursor":t.data.forEach((function(t){B(e,t)}));break;case"pencil":case"eraser":e.removeElement(t.data)}}()},children:Object(G.jsx)(P,{})})})},Y=(n(27),function(){var t=M(),e=t.globalState,n=e.stylusMode,r=e.magneticMode,i=e.wallAlignmentMode,o=t.updateGlobalState;return Object(G.jsxs)("div",{className:"settingsList",children:[Object(G.jsx)("div",{children:Object(G.jsxs)("label",{children:[Object(G.jsx)("input",{type:"checkbox",checked:null!==n&&void 0!==n&&n,onChange:function(t){return o({stylusMode:t.target.checked})}}),"\u0420\u0435\u0436\u0438\u043c \u0441\u0442\u0438\u043b\u0443\u0441\u0430"]})}),Object(G.jsx)("div",{children:Object(G.jsxs)("label",{children:[Object(G.jsx)("input",{type:"checkbox",checked:null!==i&&void 0!==i&&i,onChange:function(t){return o({wallAlignmentMode:t.target.checked})}}),"\u0420\u043e\u0432\u043d\u044b\u0435 \u0441\u0442\u0435\u043d\u044b"]})}),Object(G.jsx)("div",{children:Object(G.jsxs)("label",{children:[Object(G.jsx)("input",{type:"checkbox",checked:null!==r&&void 0!==r&&r,onChange:function(t){return o({magneticMode:t.target.checked})}}),"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u043a \u0441\u0442\u0435\u043d\u0430\u043c"]})})]})});function N(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function z(t,e,n,r){function i(t){return{id:1,x:t.pageX,y:t.pageY,type:"mouse",buttons:t.buttons,changedTouches:[{identifier:1,pageX:t.pageX,pageY:t.pageY}]}}var o=function(t){return e(i(t))},l=function(t){return n(i(t))},u=function(t){return r(i(t))};function a(t){var e=t.changedTouches[0];return{id:e.identifier,x:e.pageX,y:e.pageY,touches:Array.from(t.touches),changedTouches:Array.from(t.changedTouches),type:"stylus"===e.touchType?"stylus":"touch"}}var c=function(t){return e(a(t))},s=function(t){return n(a(t))},d=function(t){return r(a(t))};return t.addEventListener("mousedown",o),t.addEventListener("mousemove",l),t.addEventListener("mouseup",u),t.addEventListener("touchstart",c),t.addEventListener("touchmove",s),t.addEventListener("touchend",d),function(){t.removeEventListener("mousedown",o),t.removeEventListener("mousemove",l),t.removeEventListener("mouseup",u),t.removeEventListener("touchstart",c),t.removeEventListener("touchmove",s),t.removeEventListener("touchend",d)}}var F,Z=function(){var t=M(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,l=i.scale,u=i.stylusMode,a=i.magneticMode,c=i.selectedTool,s=i.plan;return Object(r.useEffect)((function(){if(e.current&&"cursor"===c){return z(e.current,(function(t){var e;u&&"touch"===t.type||(o({pointerDown:!0}),null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,n=t.pageX*l,r=t.pageY*l;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return N(t,{x:n,y:r})<=H})).forEach((function(t){t.editId=e})),D.push({tool:"cursor",data:s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).map((function(t){return{id:t.id,p1:{x:t.p1.x,y:t.p1.y},p2:{x:t.p2.x,y:t.p2.y}}}))})})))}),(function(t){var e;("mouse"!==t.type||t.buttons)&&(null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,r=t.pageX*l,i=t.pageY*l;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){t.x=r,t.y=i})),s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){return B(n,t)}))})))}),(function(t){var e,n;null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){if(t.editId=void 0,a){var e=s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(e){return e!==t&&e.x!==t.x&&e.y!==t.y})).find((function(e){return N(e,t)<=H}));e&&(t.x=e.x,t.y=e.y)}}))})),0===(null===(n=t.touches)||void 0===n?void 0:n.length)&&o({pointerDown:!1})}))}}),[e.current,l,u,a,c]),null},q=["pencil","eraser"],_=function(){var t=M(),e=t.drawing,n=t.interactiveRef,i=t.globalState,o=t.updateGlobalState,l=i.scale,u=i.stylusMode,a=i.magneticMode,c=i.selectedTool;return Object(r.useEffect)((function(){if(n.current&&q.includes(c)){var t,r=1,i=[];return z(n.current,(function(n){var a,s;if((!u||"touch"!==n.type)&&!("touch"===n.type&&n.touches.length>1)){o({pointerDown:!0});var d=n.touches&&n.touches[0],f=(null!==(a=null===d||void 0===d?void 0:d.pageX)&&void 0!==a?a:n.x)*l,h=(null!==(s=null===d||void 0===d?void 0:d.pageY)&&void 0!==s?s:n.y)*l;r=10*Math.log(((null===d||void 0===d?void 0:d.force)||.1)+1),"pencil"===c?(i.push({x:f,y:h,lineWidth:r}),t=e.drawPath({points:i,stroke:"#000",strokeWidth:r,fill:"none",groupId:"pen"}),D.push({tool:"pencil",data:t})):(t=e.drawPath({points:i,stroke:"#fff",strokeLinecap:"round",strokeWidth:20*r,fill:"none",groupId:"pen"}),D.push({tool:"eraser",data:t}))}}),(function(n){var o,a,c;if((!u||"touch"!==n.type)&&("mouse"!==n.type||n.buttons)){var s=n.touches&&n.touches[0],d=(null!==(o=null===s||void 0===s?void 0:s.pageX)&&void 0!==o?o:n.x)*l,f=(null!==(a=null===s||void 0===s?void 0:s.pageY)&&void 0!==a?a:n.y)*l;r=40*Math.log(((null===s||void 0===s?void 0:s.force)||.1)+1)*.2+.8*(null!==(c=r)&&void 0!==c?c:1),i.push({x:d,y:f,lineWidth:r}),e.drawPath({id:t,points:i})}}),(function(t){i=[],r=0,t.touches&&0!==t.touches.length||o({pointerDown:!1})}))}}),[n.current,l,u,a,c]),null},J=n(15),K=["title","titleId"];function Q(){return(Q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function U(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function $(t,e){var n=t.title,i=t.titleId,o=U(t,K);return r.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,F||(F=r.createElement("path",{d:"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})))}var tt,et=r.forwardRef($),nt=(n.p,["title","titleId"]);function rt(){return(rt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function it(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function ot(t,e){var n=t.title,i=t.titleId,o=it(t,nt);return r.createElement("svg",rt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,tt||(tt=r.createElement("path",{d:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"})))}var lt,ut=r.forwardRef(ot),at=(n.p,["title","titleId"]);function ct(){return(ct=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function st(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function dt(t,e){var n=t.title,i=t.titleId,o=st(t,at);return r.createElement("svg",ct({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,lt||(lt=r.createElement("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})))}var ft,ht=r.forwardRef(dt),vt=(n.p,["title","titleId"]);function pt(){return(pt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function yt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function gt(t,e){var n=t.title,i=t.titleId,o=yt(t,vt);return r.createElement("svg",pt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,ft||(ft=r.createElement("path",{d:"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z"})))}var bt=r.forwardRef(gt),wt=(n.p,n(28),function(){var t=M(),e=t.globalState.selectedTool,n=t.updateGlobalState,r=function(t){var r=t.type,i=t.name,o=t.icon;return Object(G.jsx)("div",{onClick:function(){n({selectedTool:r})},className:Object(J.a)("toolboxItem",e===r&&"toolboxSelectedItem"),children:null!==o&&void 0!==o?o:i})};return Object(G.jsxs)("div",{className:"toolboxContainer",children:[Object(G.jsx)(r,{type:"wall",name:"\u0421\u0442\u0435\u043d\u0430",icon:Object(G.jsx)(bt,{})}),Object(G.jsx)(r,{type:"cursor",name:"\u041a\u0443\u0440\u0441\u043e\u0440",icon:Object(G.jsx)(et,{})}),Object(G.jsx)(r,{type:"pencil",name:"\u041a\u0430\u0440\u0430\u043d\u0434\u0430\u0448",icon:Object(G.jsx)(ht,{})}),Object(G.jsx)(r,{type:"eraser",name:"\u041b\u0430\u0441\u0442\u0438\u043a",icon:Object(G.jsx)(ut,{})})]})}),xt=0,jt=function(){var t=M(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,l=i.scale,u=i.stylusMode,a=i.magneticMode,c=i.wallAlignmentMode,s=i.selectedTool,d=i.plan;return Object(r.useEffect)((function(){if(e.current&&"wall"===s){return z(e.current,(function(t){console.log("wall onStart",t);var e=t.x*l,r=t.y*l;if(!u||"touch"!==t.type)if("touch"===t.type&&t.touches.length>1)!function(t){var e=d.walls.findIndex((function(e){return e.editId===t}));if(e>=0){var r=d.walls.splice(e,1);n.removeElement(T(r[0]))}}(t.id);else{o({pointerDown:!0});var i={id:xt++,editId:t.id,p1:{x:e,y:r},p2:{x:e,y:r}};if(a){var c=d.walls.flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return N(t,i.p1)<=H}));c&&(i.p1.x=c.x,i.p1.y=c.y,i.p2.x=c.x,i.p2.y=c.y)}d.walls.push(i),X(n,i)}}),(function(t){if("mouse"!==t.type||t.buttons){var e=t.x*l,r=t.y*l,i=d.walls.find((function(e){return e.editId===t.id}));i&&(i.p2.x=e,i.p2.y=r,c&&("horizontal"===function(t){var e=t.p1,n=t.p2,r=n.x-e.x,i=n.y-e.y;return Math.abs(r)>Math.abs(i)?"horizontal":"vertical"}({p1:i.p1,p2:{x:e,y:r}})?i.p2.y=i.p1.y:i.p2.x=i.p1.x),B(n,i))}}),(function(t){console.log("wall onEnd",t);var e=t.id,r=t.touches,i=d.walls.find((function(t){return t.editId===e}));if(i){if(i.editId=void 0,a){var l=d.walls.filter((function(t){return t!==i})).flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return N(t,i.p2)<=H}));l&&(i.p2.x=l.x,i.p2.y=l.y)}B(n,i),D.push({tool:"wall",data:[i]})}0===(null===r||void 0===r?void 0:r.length)&&o({pointerDown:!1})}))}}),[e.current,u,a,c,s]),null};var mt=function(){var t=k(),e=t.drawing,n=t.drawingRef,i=t.interactiveRef,o=t.globalState.pointerDown;return Object(r.useEffect)((function(){var t=function(t){o&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),function(){document.removeEventListener("touchmove",t)}}),[o]),Object(G.jsx)(S.Provider,{value:t,children:Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(u.a,{children:Object(G.jsx)("title",{children:"Measure App"})}),Object(G.jsxs)("main",{children:[Object(G.jsx)(jt,{}),Object(G.jsx)(Z,{}),Object(G.jsx)(_,{}),Object(G.jsx)("div",{ref:i,className:"paper main",children:Object(G.jsxs)("svg",{ref:n,children:[Object(G.jsx)("g",{id:"pen"}),Object(G.jsx)("g",{id:"walls"})]})}),Object(G.jsx)(wt,{}),Object(G.jsx)(Y,{}),Object(G.jsx)(W,{drawing:e})]})]})})},Ot=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,l=e.getTTFB;n(t),r(t),i(t),o(t),l(t)}))};l.a.render(Object(G.jsx)(i.a.StrictMode,{children:Object(G.jsx)(mt,{})}),document.getElementById("root")),Ot()}},[[29,1,2]]]);
//# sourceMappingURL=main.ae954dd5.chunk.js.map