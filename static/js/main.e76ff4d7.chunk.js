(this["webpackJsonpmeasure-app"]=this["webpackJsonpmeasure-app"]||[]).push([[0],{19:function(t,e,n){},20:function(t,e,n){},22:function(t,e,n){},24:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){},30:function(t,e,n){},31:function(t,e,n){},32:function(t,e,n){},33:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),i=n(13),l=n.n(i),c=(n(19),n(20),n(2)),a=n(14);function u(t){var e=t.p1,n=t.p2,r=n.x-e.x,o=n.y-e.y;return Math.abs(r)>Math.abs(o)?"horizontal":"vertical"}function s(t,e){var n,r=t.x,o=t.y,i=e.x,l=e.y;if(i===r)n=l>o?90:270;else if(l===o)n=i>r?0:180;else{var c=(l-o)/(i-r);n=Math.atan(c)*(180/Math.PI),(i-r<0||l-o<0)&&(n+=180),i-r>0&&l-o<0&&(n-=180),n<0&&(n+=360)}return n}function d(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}var f=20;function p(t,e,n){return Math.min(e,n)<=t&&t<=Math.max(e,n)}function v(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.p1.x,i=t.p1.y,l=t.p2.x,c=t.p2.y,a=e.p1.x,u=e.p1.y,s=e.p2.x,d=e.p2.y;if(c-i!==0){var f=(l-o)/(i-c),v=a-s+(u-d)*f;if(!v)return null;var h=a-o+(u-i)*f;n=h/v}else{if(!(u-d))return null;n=(u-i)/(u-d)}var b=a+(s-a)*n,y=u+(d-u)*n;return r?p(b,o,l)&&p(b,a,s)&&p(y,i,c)&&p(y,u,d)?{x:b,y:y}:null:{x:b,y:y}}function h(t,e,n,r){var o=(r-90)*Math.PI/180;return{x:t+n*Math.cos(o),y:e+n*Math.sin(o)}}var b=n(5),y=n(4);function w(t){if(!t.length)return"";var e=t.reduce((function(t,e,n,r){var o=Object(y.a)(e,2),i=o[0],l=o[1],c=Object(y.a)(r[(n+1)%r.length],2),a=c[0],u=c[1];return t.push(i,l,(i+a)/2,(l+u)/2),t}),["M"].concat(Object(b.a)(t[0]),["Q"]));return e.push("Z"),e.join(" ")}var x="http://www.w3.org/2000/svg";function j(t,e,n,r){(void 0!==r?r:n)?t.setAttribute(e,n.toString()):t.removeAttribute(e)}function g(t,e){var n=e.fill,r=e.stroke,o=e.strokeWidth,i=e.strokeDashArray;j(t,"fill",n),j(t,"stroke",r),j(t,"stroke-width",o),j(t,"stroke-dasharray",i)}function O(t,e){g(t,e);var n=e.x1,r=e.x2,o=e.y1,i=e.y2,l=e.stroke,c=void 0===l?"#000":l,a=e.angle,u=e.rx,s=e.ry,d=(r-n)/2,f=(i-o)/2;t.setAttribute("x1",n.toString()),t.setAttribute("y1",o.toString()),t.setAttribute("x2",r.toString()),t.setAttribute("y2",i.toString()),j(t,"transform","rotate(".concat(a,", ").concat(null!==u&&void 0!==u?u:d,", ").concat(null!==s&&void 0!==s?s:f,")"),!!a),t.setAttribute("stroke",c)}function m(t,e){var n=e.cx,r=e.cy,o=e.width,i=e.height,l=e.angle,c=e.rx,a=e.ry;t.setAttribute("x",(n-o/2).toString()),t.setAttribute("y",(r-i/2).toString()),t.setAttribute("width",o.toString()),t.setAttribute("height",i.toString()),j(t,"transform","rotate(".concat(l,", ").concat(null!==c&&void 0!==c?c:n,", ").concat(null!==a&&void 0!==a?a:r,")"),!!l),g(t,e)}function E(t,e){g(t,e);var n=e.x,r=e.y,o=e.rx,i=e.ry;t.setAttribute("cx",n.toString()),t.setAttribute("cy",r.toString()),t.setAttribute("rx",o.toString()),t.setAttribute("ry",i.toString())}function k(t,e){g(t,e);var n=e.cx,r=e.cy,o=e.radius,i=e.startAngle,l=e.endAngle,c=e.angle,a=e.rx,u=e.ry,s=h(n,r,o,l),d=h(n,r,o,i),f=l-i<=180?"0":"1",p=["M",s.x,s.y,"A",o,o,0,f,0,d.x,d.y];t.setAttribute("d",p.join(" ")),j(t,"transform","rotate(".concat(c,", ").concat(null!==a&&void 0!==a?a:n,", ").concat(null!==u&&void 0!==u?u:r,")"),!!c)}function L(t,e){g(t,e);var n=e.x,r=e.y,o=e.angle,i=void 0===o?0:o,l=e.rx,c=e.ry,a=e.fontSize,u=void 0===a?14:a,s=e.text;t.setAttribute("x",n.toString()),t.setAttribute("y",(r+6).toString()),t.setAttribute("style","text-anchor: middle; font-size: ".concat(u,"px")),t.setAttribute("transform","rotate(".concat(i,", ").concat(null!==l&&void 0!==l?l:n,", ").concat(null!==c&&void 0!==c?c:r,")")),t.textContent=s}function C(t,e,n,r){var o=e?null===t||void 0===t?void 0:t.getElementById(e):void 0,i=null!==e&&void 0!==e?e:"e".concat((new Date).getTime());if(!o){(o=document.createElementNS(x,n)).setAttribute("id",i);var l=r?null===t||void 0===t?void 0:t.getElementById(r):t;null===l||void 0===l||l.appendChild(o)}return{element:o,id:i}}var I=function(t){return"w".concat(t.id)},M=function(t){return"p".concat(t.editId)};function S(t,e,n){t.drawRect({id:"w".concat(e.id,"s"),groupId:I(e),cx:e.p1.x,cy:e.p1.y,angle:s(e.p1,e.p2),width:6,height:6,strokeWidth:1,stroke:"#666",fill:"#666"})}function H(t,e,n){t.drawRect({id:"w".concat(e.id,"e"),groupId:I(e),cx:e.p2.x,cy:e.p2.y,angle:s(e.p1,e.p2),width:6,height:6,strokeWidth:1,stroke:null!==n&&void 0!==n?n:"#000",fill:"#666"})}function V(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#666",r=t.createGroup(I(e),"walls"),o=t.createGroup("".concat(r,".body"),r);if("wall"!==e.type&&"window"!==e.type&&e.type){if(t.drawLine({groupId:o,id:"w".concat(e.id,"l"),x1:e.p1.x,y1:e.p1.y,x2:e.p2.x,y2:e.p2.y,stroke:n,strokeDashArray:"3 3"}),"door"===e.type){var i,l=parseInt(null!==(i=e.variant)&&void 0!==i?i:"1")||1,c=1===l||3===l,a=1===l||2===l;t.drawLine({groupId:o,id:"w".concat(e.id,"d"),x1:e.p1.x,y1:e.p1.y,x2:e.p2.x,y2:e.p2.y,stroke:n,angle:c?-45:45,rx:a?e.p2.x:e.p1.x,ry:a?e.p2.y:e.p1.y});var u=45+(a?180:0)+(l%2===0?45:0);t.drawArc({groupId:o,id:"w".concat(e.id,"a"),cx:a?e.p2.x:e.p1.x,cy:a?e.p2.y:e.p1.y,strokeWidth:1,startAngle:u,endAngle:u+45,angle:s(e.p1,e.p2),radius:d(e.p1,e.p2),strokeDashArray:"5 5",stroke:n,fill:"none"})}else t.removeElement("w".concat(e.id,"d"),o),t.removeElement("w".concat(e.id,"a"),o);t.removeElement("w".concat(e.id,"r"),o)}else t.drawRect({groupId:o,id:"w".concat(e.id,"r"),cx:(e.p1.x+e.p2.x)/2,cy:(e.p1.y+e.p2.y)/2,angle:s(e.p1,e.p2),width:d(e.p1,e.p2)-6,height:"window"===e.type?3:6,strokeWidth:1,stroke:n,fill:"window"===e.type?"none":n}),t.removeElement("w".concat(e.id,"l"),o),t.removeElement("w".concat(e.id,"d"),o),t.removeElement("w".concat(e.id,"a"),o);e.type&&"wall"!==e.type&&"door"!==e.type?(t.removeElement("w".concat(e.id,"s"),r),t.removeElement("w".concat(e.id,"e"),r)):(S(t,e),H(t,e,n)),P(t,e,n)}function P(t,e,n){var r=I(e),o=(e.p1.x+e.p2.x)/2,i=(e.p1.y+e.p2.y)/2,l=s(e.p1,e.p2);l>=90&&l<270&&(l-=180);var c=-l*Math.PI/180;e.topText?t.drawText({groupId:r,id:"w".concat(e.id,"t1"),text:"".concat(e.topText),x:o-14*Math.sin(c),y:i-14*Math.cos(c),fill:n,angle:l}):t.removeElement("w".concat(e.id,"t1"),r),e.bottomText?t.drawText({groupId:r,id:"w".concat(e.id,"t2"),text:"".concat(e.bottomText),x:o+14*Math.sin(c),y:i+14*Math.cos(c),fill:n,angle:l}):t.removeElement("w".concat(e.id,"t2"),r)}function A(t,e,n){var r=t.createGroup(M(e),"guide"),o=n.map((function(n){var o="p".concat(e.editId,"g").concat(n.wall.id);return t.drawLine({groupId:r,id:o,x1:e.x,y1:e.y,x2:n.point.x,y2:n.point.y,strokeDashArray:"10 10"}),o}));t.removeElements((function(t){return!o.includes(t.id)}),r)}function T(t,e){t.removeElement(M(e),"guide")}var R=[],N=[];function B(t,e){Object.entries(t).forEach((function(t){var n=Object(y.a)(t,2),r=n[0],o=n[1];e[r]=o}));var n=Object.keys(t);Object.keys(e).filter((function(t){return!n.includes(t)})).forEach((function(t){delete e[t]}))}function D(t){localStorage.setItem("plan",JSON.stringify(t))}function W(t,e){var n,r;null===e||void 0===e||null===(n=e.walls)||void 0===n||n.forEach((function(e){return V(t,e)})),null===e||void 0===e||null===(r=e.notes)||void 0===r||r.forEach((function(e){return t.drawPath(e)}))}function X(t,e){var n,r;null===(n=e.walls)||void 0===n||n.forEach((function(e){return t.removeElement(I(e))})),null===(r=e.notes)||void 0===r||r.filter((function(t){return t.id})).forEach((function(e){return t.removeElement(e.id)}))}var Z={settings:function(){var t={stylusMode:!0,magneticMode:!0,wallAlignmentMode:!0,selectedTool:"wall"};try{var e=localStorage.getItem("settings");return e?JSON.parse(e):t}catch(n){}return t}(),pointerDown:!1,scale:1,plan:function(){var t={walls:[],notes:[]};try{var e=localStorage.getItem("plan");if(!e)return t;var n=JSON.parse(e);return console.log("Restore plan",n),n}catch(r){console.log("Failed to restore plan")}return t}()};function z(){var t=Object(c.a)({defaultValues:Z}),e=t.control,n=t.getValues,o=t.setValue,i=Z.plan,l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Object(r.useRef)(null);return Object(r.useEffect)((function(){function n(){var n=e.current,r=null===n||void 0===n?void 0:n.parentElement;if(n&&r){var o=r.getBoundingClientRect(),i=o.width,l=o.height;n.setAttribute("viewBox","0 0 ".concat(i*t," ").concat(l*t)),n.setAttribute("version","1.1"),n.setAttribute("xmlns",x)}}return n(),window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,e]),{svgRef:e,drawing:{drawLine:function(t){var n=C(e.current,t.id,"line",t.groupId),r=n.element,o=n.id;return O(r,t),o},drawCircle:function(t){var n=C(e.current,t.id,"ellipse",t.groupId),r=n.element,o=n.id;return E(r,t),o},drawArc:function(t){var n=C(e.current,t.id,"path",t.groupId),r=n.element,o=n.id;return k(r,t),o},drawRect:function(t){var n=C(e.current,t.id,"rect",t.groupId),r=n.element,o=n.id;return m(r,t),o},drawText:function(t){var n=C(e.current,t.id,"text",t.groupId),r=n.element,o=n.id;return L(r,t),o},createGroup:function(t,n){return C(e.current,t,"g",n).id},removeElement:function(t,n){var r,o=n?null===(r=e.current)||void 0===r?void 0:r.getElementById(n):e.current,i=null===o||void 0===o?void 0:o.querySelector("#".concat(t));null===i||void 0===i||i.remove()},removeElements:function(t,n){var r,o,i=n?null===(r=e.current)||void 0===r?void 0:r.getElementById(n):e.current;null===i||void 0===i||null===(o=i.childNodes)||void 0===o||o.forEach((function(e){t(e)&&e.remove()}))},drawPath:function(t){var n=t.id,r=t.points,o=t.groupId,i=C(e.current,n,"path",o),l=i.element,c=i.id;return t.stroke&&l.setAttribute("fill",t.stroke),l.setAttribute("d",w(Object(a.a)(r,{size:t.strokeWidth,smoothing:.5,thinning:.5}))),c}}}}(Z.scale),u=l.svgRef,s=l.drawing,d=function(t,e){return Object(r.useMemo)((function(){return{add:function(t){R.push(t),N=[],D(e)},undo:function(){var n=R.pop();if(n){switch(N.push(n),n.tool){case"wall":var r=(null===n||void 0===n?void 0:n.data).addedWall;e.walls=e.walls.filter((function(t){return t!==r})),t.removeElement(I(r));break;case"cursor":n.data.before.forEach((function(n){e.walls.filter((function(t){return t.id===n.id})).forEach((function(e){B(n,e),V(t,e)}))}));break;case"pencil":case"eraser":var o=n.data.options;o.id&&(e.notes=e.notes.filter((function(t){return t.id!==o.id})),t.removeElement(o.id));break;case"destroy":n.data.destroyedWalls.forEach((function(n){e.walls.push(n),V(t,n)}))}D(e)}},redo:function(){var n=N.pop();if(n){switch(R.push(n),n.tool){case"wall":var r=(null===n||void 0===n?void 0:n.data).addedWall;e.walls.push(r),V(t,r);break;case"cursor":n.data.after.forEach((function(n){e.walls.filter((function(t){return t.id===n.id})).forEach((function(e){B(n,e),V(t,e)}))}));break;case"pencil":case"eraser":var o=n.data.options;e.notes.push(o),t.drawPath(o);break;case"destroy":var i=n.data.destroyedWalls;i.forEach((function(e){return t.removeElement(I(e))})),e.walls=e.walls.filter((function(t){return!i.includes(t)}))}D(e)}},clear:function(){R=[],N=[]}}}),[e,t])}(s,i);Object(r.useEffect)((function(){W(s,Z.plan)}),[s]);var f=Object(r.useRef)(null);return{drawing:s,drawingRef:u,interactiveRef:f,control:e,getValues:n,setValue:o,commandsHistory:d}}var F,G=o.a.createContext(null),J=function(){var t=o.a.useContext(G);if(null===t)throw new Error("useGlobalContext must be used within an GlobalContext.Provider");return t};function Y(t){var e,n,r,o=null!==(e=null===(n=t.current)||void 0===n||null===(r=n.getAttribute("viewBox"))||void 0===r?void 0:r.split(" ").map((function(t){return parseInt(t)})))&&void 0!==e?e:[0,0],i=t.current.getBoundingClientRect();return{x:o[0],y:o[1],width:o[2],height:o[3],ratio:i.width/o[3]}}function K(t,e,n){return t.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return d(t,{x:e,y:n})<=8}))}function U(t,e,n){return t.walls.find((function(t){var r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.p1.x,o=e.p1.y,i=e.p2.x,l=e.p2.y,c=t.x,a=t.y,u=(r*r*c-2*r*i*c+i*i*c+i*(o-l)*(o-a)-r*(o-l)*(l-a))/((r-i)*(r-i)+(o-l)*(o-l)),s=(i*i*o+r*r*l+i*c*(l-o)-r*(c*(l-o)+i*(o+l))+(o-l)*(o-l)*a)/((r-i)*(r-i)+(o-l)*(o-l));return n?p(u,r,i)&&p(s,o,l)?{x:u,y:s}:null:{x:u,y:s}}({x:e,y:n},t,!0);return r&&d({x:e,y:n},r)<8}))}var q=["title","titleId"];function Q(){return(Q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function $(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function _(t,e){var n=t.title,o=t.titleId,i=$(t,q);return r.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,F||(F=r.createElement("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19C6,20.1 6.9,21 8,21H16C17.1,21 18,20.1 18,19V7H6V19Z"})))}var tt,et=r.forwardRef(_),nt=(n.p,["title","titleId"]);function rt(){return(rt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function ot(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function it(t,e){var n=t.title,o=t.titleId,i=ot(t,nt);return r.createElement("svg",rt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,tt||(tt=r.createElement("path",{d:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"})))}var lt,ct=r.forwardRef(it),at=(n.p,["title","titleId"]);function ut(){return(ut=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function st(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function dt(t,e){var n=t.title,o=t.titleId,i=st(t,at);return r.createElement("svg",ut({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,lt||(lt=r.createElement("path",{d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})))}var ft,pt=r.forwardRef(dt),vt=(n.p,n(6)),ht=(n(22),n(1)),bt=function(t){var e=t.id,n=t.icon,r=t.title,o=t.active,i=t.className,l=t.children,c=t.onClick;return Object(ht.jsxs)("div",{id:e,role:"button",title:r,className:Object(vt.a)("roundButton",o&&"roundButtonActive",i),onClick:c,"data-testid":e,children:[n,l]})},yt=(n(24),function(){var t=J(),e=t.drawing,n=t.commandsHistory,o=t.control,i=Object(c.b)({control:o,name:"plan"});return Object(r.useEffect)((function(){var t=function(t){(t.ctrlKey||t.metaKey)&&("KeyZ"===t.code?n.undo():"KeyY"===t.code&&n.redo())};return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)}}),[n]),Object(ht.jsxs)("div",{className:"historyPanel",children:[Object(ht.jsx)(bt,{title:"Undo",onClick:n.undo,icon:Object(ht.jsx)(pt,{})}),Object(ht.jsx)(bt,{title:"Redo",onClick:n.redo,icon:Object(ht.jsx)(ct,{})}),Object(ht.jsx)(bt,{title:"Clear",onClick:function(){confirm("Are you sure want to delete all?")&&(n.clear(),X(e,i),i.walls=[],i.notes=[],D(i))},icon:Object(ht.jsx)(et,{})})]})}),wt=n(9),xt=n(11),jt=n.n(xt),gt=["title","titleId"];function Ot(){return(Ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function mt(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Et(t,e){var n=t.title,o=t.titleId,i=mt(t,gt);return r.createElement("svg",Ot({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,ft||(ft=r.createElement("path",{d:"M19,15.59L17.59,17L14,13.41L10.41,17L9,15.59L12.59,12L9,8.41L10.41,7L14,10.59L17.59,7L19,8.41L15.41,12L19,15.59M22,3C23.1,3 24,3.9 24,5V19C24,20.1 23.1,21 22,21H7C6.31,21 5.77,20.64 5.41,20.11L0,12L5.41,3.88C5.77,3.35 6.31,3 7,3H22M22,5H7L2.28,12L7,19H22V5Z"})))}var kt,Lt=r.forwardRef(Et),Ct=(n.p,["title","titleId"]);function It(){return(It=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Mt(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function St(t,e){var n=t.title,o=t.titleId,i=Mt(t,Ct);return r.createElement("svg",It({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,kt||(kt=r.createElement("path",{d:"M9,3L5,7H8V14H10V7H13M16,17V10H14V17H11L15,21L19,17H16Z"})))}var Ht,Vt=r.forwardRef(St),Pt=(n.p,n(27),["title","titleId"]);function At(){return(At=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Tt(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Rt(t,e){var n=t.title,o=t.titleId,i=Tt(t,Pt);return r.createElement("svg",At({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Ht||(Ht=r.createElement("path",{d:"M8,3C6.89,3 6,3.89 6,5V21H18V5C18,3.89 17.11,3 16,3H8M8,5H16V19H8V5M13,11V13H15V11H13Z"})))}var Nt,Bt=r.forwardRef(Rt),Dt=(n.p,["title","titleId"]);function Wt(){return(Wt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Xt(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Zt(t,e){var n=t.title,o=t.titleId,i=Xt(t,Dt);return r.createElement("svg",Wt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Nt||(Nt=r.createElement("path",{d:"M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z"})))}var zt,Ft=r.forwardRef(Zt),Gt=(n.p,["title","titleId"]);function Jt(){return(Jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Yt(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Kt(t,e){var n=t.title,o=t.titleId,i=Yt(t,Gt);return r.createElement("svg",Jt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,zt||(zt=r.createElement("path",{d:"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z"})))}var Ut,qt=r.forwardRef(Kt),Qt=(n.p,["title","titleId"]);function $t(){return($t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function _t(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function te(t,e){var n=t.title,o=t.titleId,i=_t(t,Qt);return r.createElement("svg",$t({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Ut||(Ut=r.createElement("path",{d:"M21,20V2H3V20H1V23H23V20M19,4V11H13V4M5,4H11V11H5M5,20V13H11V20M13,20V13H19V20Z"})))}var ee,ne=r.forwardRef(te),re=(n.p,n(28),function(t){var e=t.wallType,n=void 0===e?"wall":e,r=t.variant,o=t.onSubmit,i=function(t){var e=t.type,i=t.icon;return Object(ht.jsx)("button",{className:Object(vt.a)("wall-type-button",n===e&&"wall-type-active-button"),onClick:function(){if("door"===e&&"door"===n){var t=(parseInt(null!==r&&void 0!==r?r:"1")||2)%4+1;o(e,t.toString())}else o(e)},children:i})};return Object(ht.jsxs)("div",{className:"wall-types-container",children:[Object(ht.jsx)(i,{type:"wall",icon:Object(ht.jsx)(qt,{width:18,height:18})}),Object(ht.jsx)(i,{type:"window",icon:Object(ht.jsx)(ne,{width:14,height:14})}),Object(ht.jsx)(i,{type:"door",icon:Object(ht.jsx)(Bt,{width:18,height:18})}),Object(ht.jsx)(i,{type:"ruler",icon:Object(ht.jsx)(Ft,{width:16,height:16})})]})}),oe=function(t){var e=t.icon,n=t.title,r=t.value,o=t.className,i=t.onClick;return Object(ht.jsx)("button",{title:n,className:Object(vt.a)("keyboard-button",o),onClick:function(){return i()},children:null!==e&&void 0!==e?e:r})},ie=function(t){var e=t.topText,n=t.bottomText,o=t.onSubmit,i=void 0===o?function(){}:o,l=Object(r.useState)(!e&&n?1:0),c=Object(y.a)(l,2),a=c[0],u=c[1],s=Object(r.useState)(null!==e&&void 0!==e?e:""),d=Object(y.a)(s,2),f=d[0],p=d[1],v=Object(r.useState)(null!==n&&void 0!==n?n:""),h=Object(y.a)(v,2),b=h[0],w=h[1],x=0===a?p:w;Object(r.useEffect)((function(){p(null!==e&&void 0!==e?e:""),w(null!==n&&void 0!==n?n:"")}),[e,n]);var j=function(){return i(f,b)},g=function(t){"0123456789".includes(t.key)?x((function(e){return e+t.key})):"Backspace"===t.key?x((function(t){return t.substring(0,t.length-1)})):"Enter"===t.key&&j()},O=function(t){var e=t.value;return Object(ht.jsx)("button",{title:e,className:"keyboard-button",onClick:function(){return x((function(t){return t+e}))},children:e})};return Object(ht.jsx)("div",{children:Object(ht.jsx)("table",{className:"keyboard",children:Object(ht.jsxs)("tbody",{children:[Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{colSpan:2,className:"keyboard-input-cell",children:Object(ht.jsx)("div",{tabIndex:0,onKeyDown:g,onClick:function(){return u(0)},className:Object(vt.a)("keyboard-input",0===a&&"keyboard-active-input",!f&&"keyboard-empty-input"),children:Object(ht.jsx)("span",{children:f||"Top"})})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(oe,{title:"Swap",icon:Object(ht.jsx)(Vt,{width:18,height:18}),onClick:function(){p(b),w(f)}})})]}),Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{colSpan:2,className:"keyboard-input-cell",children:Object(ht.jsx)("div",{tabIndex:0,onKeyDown:g,onClick:function(){return u(1)},className:Object(vt.a)("keyboard-input",1===a&&"keyboard-active-input",!b&&"keyboard-empty-input"),children:Object(ht.jsx)("span",{children:b||"Bottom"})})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(oe,{title:"Backspace",icon:Object(ht.jsx)(Lt,{width:16,height:16}),onClick:function(){return x((function(t){return t.substring(0,t.length-1)}))}})})]}),Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"7"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"8"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"9"})})]}),Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"4"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"5"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"6"})})]}),Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"1"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"2"})}),Object(ht.jsx)("td",{children:Object(ht.jsx)(O,{value:"3"})})]}),Object(ht.jsxs)("tr",{children:[Object(ht.jsx)("td",{colSpan:2,children:Object(ht.jsx)(O,{value:"0"})}),Object(ht.jsx)("td",{className:"keyboard-submit",children:Object(ht.jsx)(oe,{value:"OK",onClick:j})})]})]})})})},le=function(){var t=J(),e=t.control,n=t.drawingRef,r=t.drawing,o=t.commandsHistory,i=t.setValue,l=Object(c.b)({control:e,name:"selectedWall"}),a=Object(c.b)({control:e,name:"scale"}),u=Object(c.b)({control:e,name:"plan"});if(!l)return null;var s=Y(n),d=((l.p1.x+l.p2.x)/2-s.x)/a,f=((l.p1.y+l.p2.y)/2-s.y)/a;return Object(ht.jsxs)("div",{className:"mini-keyboard",style:{top:"".concat(f+5,"px"),left:"".concat(d+5,"px")},children:[Object(ht.jsx)(re,{wallType:l.type,variant:l.variant,onSubmit:function(t,e){var n=u.walls.find((function(t){return t.id===l.id}));n&&(n.type=t,n.variant=e,o.add({tool:"cursor",data:{before:[jt()(l)],after:[jt()(n)]}}),V(r,n)),i("selectedWall",Object(wt.a)(Object(wt.a)({},l),{},{type:t,variant:e}))}}),Object(ht.jsx)(ie,{topText:l.topText,bottomText:l.bottomText,onSubmit:function(t,e){var n=u.walls.find((function(t){return t.id===l.id}));n&&(n.topText=t,n.bottomText=e,o.add({tool:"cursor",data:{before:[jt()(l)],after:[jt()(n)]}}),V(r,n)),i("selectedWall",void 0)}})]})},ce=function(){var t=J().control,e=Object(c.b)({control:t,name:"pointerDown"});return Object(r.useEffect)((function(){var t=function(t){e&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),function(){document.removeEventListener("touchmove",t)}}),[e]),null},ae=["title","titleId"];function ue(){return(ue=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function se(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function de(t,e){var n=t.title,o=t.titleId,i=se(t,ae);return r.createElement("svg",ue({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,ee||(ee=r.createElement("path",{d:"M12,1L8,5H11V14H13V5H16M18,23H6C4.89,23 4,22.1 4,21V9C4,7.9 4.9,7 6,7H9V9H6V21H18V9H15V7H18C19.1,7 20,7.9 20,9V21C20,22.1 19.1,23 18,23Z"})))}var fe,pe=r.forwardRef(de),ve=(n.p,["title","titleId"]);function he(){return(he=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function be(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function ye(t,e){var n=t.title,o=t.titleId,i=be(t,ve);return r.createElement("svg",he({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,fe||(fe=r.createElement("path",{d:"M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18C2,19.1 2.9,20 4,20H20C21.1,20 22,19.1 22,18V8C22,6.89 21.1,6 20,6Z"})))}var we,xe=r.forwardRef(ye),je=(n.p,["title","titleId"]);function ge(){return(ge=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Oe(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function me(t,e){var n=t.title,o=t.titleId,i=Oe(t,je);return r.createElement("svg",ge({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,we||(we=r.createElement("path",{d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})))}var Ee=r.forwardRef(me);n.p;function ke(t,e,n){var r=document.createElement("a"),o=new Blob([t],{type:n});r.href=URL.createObjectURL(o),r.download=e,r.click(),r.remove()}n(29);var Le,Ce=function(){var t=J(),e=t.drawing,n=t.drawingRef,o=t.control,i=Object(c.b)({control:o,name:"plan"}),l=Object(r.useCallback)((function(){return function(t){var e=t.cloneNode(!0),n=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),r=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",n);r.replaceChild(e,r.documentElement),ke((new XMLSerializer).serializeToString(r).replace(/></g,">\n\r<"),"Plan ".concat((new Date).toLocaleDateString(),".svg"),"image/svg+xml")}(n.current)}),[n]),a=Object(r.useCallback)((function(){ke(JSON.stringify(i),"Plan ".concat((new Date).toLocaleDateString(),".json"),"text/plain")}),[i]),u=Object(r.useCallback)((function(){!function(t){var e=document.createElement("input");e.type="file",e.onchange=function(n){if(e.files&&0!==e.files.length){var r=e.files[0],o=new FileReader;o.readAsText(r,"UTF-8"),o.onload=function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r)}}},e.click()}((function(t){try{var n,r;if(!t)return;X(e,i);var o=JSON.parse(t);console.log("Load JSON",o),i.walls=null!==(n=o.walls)&&void 0!==n?n:[],i.notes=null!==(r=o.notes)&&void 0!==r?r:[],W(e,o),D(o)}catch(l){console.log("Failed to load plan")}}))}),[i,e]);return Object(ht.jsxs)("div",{className:"fileActionsContainer",children:[Object(ht.jsx)(bt,{icon:Object(ht.jsx)(xe,{}),onClick:u,title:"Open"}),Object(ht.jsx)(bt,{icon:Object(ht.jsx)(Ee,{}),onClick:a,title:"Save"}),Object(ht.jsx)(bt,{icon:Object(ht.jsx)(pe,{}),onClick:l,title:"Export"})]})},Ie=["title","titleId"];function Me(){return(Me=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Se(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function He(t,e){var n=t.title,o=t.titleId,i=Se(t,Ie);return r.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Le||(Le=r.createElement("path",{d:"M12,15.5C10.07,15.5 8.5,13.93 8.5,12C8.5,10.07 10.07,8.5 12,8.5C13.93,8.5 15.5,10.07 15.5,12C15.5,13.93 13.93,15.5 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"})))}var Ve=r.forwardRef(He),Pe=(n.p,n(30),function(){var t=J(),e=t.control,n=t.setValue,o=Object(c.b)({control:e,name:"settings"}),i=o.stylusMode,l=o.magneticMode,a=o.wallAlignmentMode;return Object(r.useEffect)((function(){!function(t){localStorage.setItem("settings",JSON.stringify(t))}(o)}),[o]),Object(ht.jsxs)("div",{className:"settingsList",children:[Object(ht.jsx)("div",{className:"settingsHeader",children:Object(ht.jsx)("h2",{children:"Settings"})}),Object(ht.jsx)("div",{children:Object(ht.jsxs)("label",{children:[Object(ht.jsx)("input",{type:"checkbox",checked:null!==i&&void 0!==i&&i,onChange:function(t){return n("settings.stylusMode",t.target.checked)}}),"Stylus mode"]})}),Object(ht.jsx)("div",{children:Object(ht.jsxs)("label",{children:[Object(ht.jsx)("input",{type:"checkbox",checked:null!==a&&void 0!==a&&a,onChange:function(t){return n("settings.wallAlignmentMode",t.target.checked)}}),"Walls alignment"]})}),Object(ht.jsx)("div",{children:Object(ht.jsxs)("label",{children:[Object(ht.jsx)("input",{type:"checkbox",checked:null!==l&&void 0!==l&&l,onChange:function(t){return n("settings.magneticMode",t.target.checked)}}),"Magnet mode"]})})]})}),Ae=(n(31),function(){return Object(ht.jsxs)("div",{className:"todoListPanel",children:[Object(ht.jsx)("div",{className:"todoListHeader",children:Object(ht.jsx)("h2",{children:"Todo list"})}),Object(ht.jsxs)("ol",{className:"todoList",children:[Object(ht.jsx)("li",{children:"custom zoom"}),Object(ht.jsx)("li",{children:"add cutter tool"}),Object(ht.jsx)("li",{children:"translate app"}),Object(ht.jsx)("li",{children:"store history"}),Object(ht.jsx)("li",{children:"keyboard fix"}),Object(ht.jsx)("li",{children:"pen color, width"})]})]})}),Te=function(){var t=Object(r.useState)(!1),e=Object(y.a)(t,2),n=e[0],o=e[1];return Object(ht.jsxs)("div",{className:"settingsPanel",children:[Object(ht.jsxs)("div",{className:"settingsPanelButtons",children:[Object(ht.jsx)(Ce,{}),Object(ht.jsx)(bt,{active:n,title:"Settings",icon:Object(ht.jsx)(Ve,{}),onClick:function(){return o((function(t){return!t}))}})]}),Object(ht.jsx)("div",{className:Object(vt.a)("settingsContainer",!n&&"settingsContainerHidden"),children:Object(ht.jsxs)("div",{className:"settingsPage",children:[Object(ht.jsx)(Pe,{}),Object(ht.jsx)(Ae,{})]})})]})};function Re(t,e,n,r){function o(t){var e=[{identifier:1,pageX:t.pageX,pageY:t.pageY}];return{id:1,x:t.pageX,y:t.pageY,type:"mouse",buttons:t.buttons,changedTouches:e,touches:e}}var i=function(t){return e(o(t))},l=function(t){return n(o(t))},c=function(t){return r(o(t))};function a(t){var e=t.changedTouches[0];return{id:e.identifier,x:e.pageX,y:e.pageY,touches:Array.from(t.touches),changedTouches:Array.from(t.changedTouches),type:"stylus"===e.touchType?"stylus":"touch"}}var u=function(t){return e(a(t))},s=function(t){return n(a(t))},d=function(t){return r(a(t))};return t.addEventListener("mousedown",i),t.addEventListener("mousemove",l),t.addEventListener("mouseup",c),t.addEventListener("touchstart",u),t.addEventListener("touchmove",s),t.addEventListener("touchend",d),function(){t.removeEventListener("mousedown",i),t.removeEventListener("mousemove",l),t.removeEventListener("mouseup",c),t.removeEventListener("touchstart",u),t.removeEventListener("touchmove",s),t.removeEventListener("touchend",d)}}function Ne(t){return t.filter((function(t){return t.p1.editId||t.p2.editId})).map((function(t){return{id:t.id,topText:t.topText,bottomText:t.bottomText,p1:{x:t.p1.x,y:t.p1.y},p2:{x:t.p2.x,y:t.p2.y}}}))}var Be,De=function(){var t=J(),e=t.commandsHistory,n=t.interactiveRef,o=t.drawingRef,i=t.drawing,l=t.control,a=t.setValue,u=Object(c.b)({control:l,name:"settings"}),s=u.stylusMode,p=u.magneticMode,v=u.wallAlignmentMode,h=u.selectedTool,b=Object(c.b)({control:l,name:"scale"}),y=Object(c.b)({control:l,name:"plan"});return Object(r.useEffect)((function(){if(n.current&&"cursor"===h){n.current.style.cursor="default";var t,r,l=[],c=Re(n.current,(function(t){var e;if(!s||"touch"!==t.type){a("pointerDown",!0);var c=Y(o);null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,o=c.x+t.pageX*b,u=c.y+t.pageY*b,s=K(y,o,u);s.forEach((function(t){t.editId=e}));var d=0===s.length?U(y,o,u):void 0;r&&V(i,r),(r=d)&&V(i,r,"#00f"),a("selectedWall",r),s.length>0&&(n.current.style.cursor="move"),l=Ne(y.walls)}))}}),(function(e){var l;if(!s||"touch"!==e.type){var c=Y(o);if("mouse"===e.type){var a=c.x+e.x*b,u=c.y+e.y*b;t&&t!==r&&V(i,t),t=U(y,a,u),K(y,a,u).length>0?n.current.style.cursor=e.buttons?"move":"pointer":t?(V(i,t,"blue"),n.current.style.cursor="pointer"):n.current.style.cursor="default"}null===(l=e.changedTouches)||void 0===l||l.forEach((function(t){var e=t.identifier,n=c.x+t.pageX*b,r=c.y+t.pageY*b,o=y.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e}));if(o.forEach((function(t){t.x=n,t.y=r})),p&&o.length>0){var l=function(t,e,n){var r=[];return t.forEach((function(t){Math.abs(t.p1.x-n.x)<f&&(r.push({wall:t,point:t.p1}),e.forEach((function(e){e.x=t.p1.x}))),Math.abs(t.p1.y-n.y)<f&&(r.push({wall:t,point:t.p1}),e.forEach((function(e){e.y=t.p1.y}))),Math.abs(t.p2.x-n.x)<f&&(r.push({wall:t,point:t.p2}),e.forEach((function(e){e.x=t.p2.x}))),Math.abs(t.p2.y-n.y)<f&&(r.push({wall:t,point:t.p2}),e.forEach((function(e){e.y=t.p2.y})))})),r}(y.walls,o,{x:n,y:r});A(i,o[0],l)}y.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){return V(i,t)}))}))}}),(function(t){var r,c;if(!s||"touch"!==t.type){var u=Y(o);if("mouse"===t.type){var f=u.x+t.x*b,v=u.y+t.y*b;K(y,f,v).length>0||U(y,f,v)?n.current.style.cursor="pointer":n.current.style.cursor="default"}null===(r=t.changedTouches)||void 0===r||r.forEach((function(t){var n=t.identifier;y.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===n})).forEach((function(t){if(p){var e=y.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(e){return e!==t})).find((function(e){return d(e,t)<=8}));e&&(t.x=e.x,t.y=e.y)}}));var r=y.walls.filter((function(t){return t.p1.editId||t.p2.editId})).filter((function(t){var e=l.find((function(e){return e.id===t.id}));return e&&!function(t,e){return t.p1.x===e.p1.x&&t.p1.y===e.p1.y&&t.p2.x===e.p2.x&&t.p2.y===e.p2.y}(t,e)})).length>0;y.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){t.p1.editId=void 0,t.p2.editId=void 0,V(i,t)})),r&&e.add({tool:"cursor",data:{before:l,after:Ne(y.walls)}}),T(i,{editId:n,x:0,y:0})})),t.touches&&0!==(null===(c=t.touches)||void 0===c?void 0:c.length)||a("pointerDown",!1)}}));return function(){c(),t&&V(i,t),r&&(V(i,r),a("selectedWall",void 0))}}}),[b,s,p,v,e,n,h,y.walls,o,i,y,a]),null},We=function(){var t=J(),e=t.commandsHistory,n=t.interactiveRef,o=t.drawingRef,i=t.drawing,l=t.control,a=t.setValue,u=Object(c.b)({control:l,name:"settings"}),s=u.stylusMode,d=u.selectedTool,f=Object(c.b)({control:l,name:"scale"}),p=Object(c.b)({control:l,name:"plan"});return Object(r.useEffect)((function(){if(n.current&&"destroy"===d){var t;n.current.style.cursor="crosshair";var r=[],l=Re(n.current,(function(e){if((!s||"touch"!==e.type)&&!("touch"===e.type&&e.touches.length>1)){var n=Y(o),r=n.x+e.x*f,i=n.y+e.y*f;a("pointerDown",!0),t={x:r,y:i,editId:e.id}}}),(function(e){if(!s||"touch"!==e.type){var l=Y(o),c=l.x+e.x*f,a=l.y+e.y*f;if(r.forEach((function(t){V(i,t)})),r=[],"mouse"===e.type&&!e.buttons){var u=U(p,c,a);u&&r.push(u),n.current.style.cursor=u?"pointer":"crosshair"}if(t){i.createGroup("cross","walls"),i.drawLine({id:"d".concat(e.id),x1:t.x,y1:t.y,x2:c,y2:a,stroke:"red",strokeWidth:f,groupId:"cross"});var d={id:"".concat(e.id),p1:t,p2:{x:c,y:a}},h=p.walls.map((function(t){var e=v(t,d,!0);return e?{point:e,wall:t}:void 0})).filter((function(t){return t})).map((function(t,e){var n=t,o=n.point,l=n.wall;r.push(l);var c,a,u,s,d,f,p,v,h="x".concat(l.id);return c=i,a=h,u="cross",s=o.x,d=o.y,f=5,p="red",c.drawCircle({id:a,groupId:u,x:s,y:d,rx:f,ry:f,fill:p,stroke:v}),h}));i.removeElements((function(t){return t.id.startsWith("x")&&!h.includes(t.id)}),"cross")}r.forEach((function(t){V(i,t,"red")}))}}),(function(n){var l;if(!s||"touch"!==n.type){var c=Y(o),u=c.x+n.x*f,d=c.y+n.y*f,h=[];if(t){var b={id:"".concat(n.id),p1:t,p2:{x:u,y:d}};h=p.walls.filter((function(t){return v(t,b,!0)})),i.removeElement("cross")}var y=U(p,u,d);y&&h.push(y),h.forEach((function(t){return i.removeElement(I(t))})),p.walls=p.walls.filter((function(t){return!h.includes(t)})),r=[],e.add({tool:"destroy",data:{destroyedWalls:h}}),t=void 0,n.touches&&0!==(null===(l=n.touches)||void 0===l?void 0:l.length)||a("pointerDown",!1)}}));return function(){l(),i.removeElement("cross"),r.forEach((function(t){return V(i,t)}))}}}),[f,s,e,n,d,o,i,p,a]),null},Xe=function(){var t=J(),e=t.commandsHistory,n=t.interactiveRef;return Object(r.useEffect)((function(){if(n.current){var t=0,r=[];return Re(n.current,(function(t){var e;null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.pageX,n=t.pageY,o=t.identifier.toString();r.find((function(t){return t.id===o}))||r.push({id:o,p1:{x:e,y:n},p2:{x:e,y:n}})}))}),(function(t){var e;null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.pageX,n=t.pageY,o=t.identifier.toString(),i=r.find((function(t){return t.id===o}));i&&(i.p2.x=e,i.p2.y=n)}))}),(function(n){var o,i=(new Date).getTime(),l=i-t;if(t=i,n.touches&&!((null===(o=n.touches)||void 0===o?void 0:o.length)>0)){var c=r.filter((function(t){return d(t.p1,t.p2)<10})).length;l<500&&2===r.length&&2===c?e.undo():l<500&&3===r.length&&3===c&&e.redo(),r=[]}}))}}),[e,n]),null},Ze=function(){var t=J(),e=t.interactiveRef,n=t.drawingRef,o=t.control,i=t.setValue,l=Object(c.b)({control:o,name:"settings"}),a=l.stylusMode,u=l.selectedTool,s=Object(c.b)({control:o,name:"scale"});return Object(r.useEffect)((function(){if(e.current&&n.current&&(a||"move"===u)){var t,r;"move"===u&&(e.current.style.cursor="grab");return Re(e.current,(function(o){var l;if((!a||"touch"===o.type||"move"===u)&&1===(null===(l=o.touches)||void 0===l?void 0:l.length)){var c,d,f,p,v=o.x*s,h=o.y*s;t={x:v,y:h};var b=null!==(c=null===(d=n.current)||void 0===d||null===(f=d.getAttribute("viewBox"))||void 0===f||null===(p=f.split(" "))||void 0===p?void 0:p.map((function(t){return parseInt(t)})))&&void 0!==c?c:[0,0];r={x:b[0],y:b[1]},i("pointerDown",!0),e.current.style.cursor="grabbing"}}),(function(e){var o;if((!a||"touch"===e.type||"move"===u)&&1===(null===(o=e.touches)||void 0===o?void 0:o.length)){var i,l,c,d=e.x*s,f=e.y*s;if(!t||!r)return;var p=r.x-(d-t.x),v=r.y-(f-t.y),h=n.current.getBoundingClientRect(),b=null!==(i=null===(l=n.current.getAttribute("viewBox"))||void 0===l?void 0:l.split(" "))&&void 0!==i?i:[0,0,h.width,h.height],y="".concat(p," ").concat(v," ").concat(b[2]," ").concat(b[3]);null===(c=n.current)||void 0===c||c.setAttribute("viewBox",y)}}),(function(n){a&&"touch"!==n.type&&"move"!==u||(t=void 0,r=void 0,e.current.style.cursor="grab",i("pointerDown",!1))}))}}),[n,e,s,u,a,i]),null},ze=function(){var t=J(),e=t.commandsHistory,n=t.interactiveRef,o=t.drawingRef,i=t.drawing,l=t.control,a=t.setValue,u=Object(c.b)({control:l,name:"settings"}),s=u.stylusMode,d=u.magneticMode,f=u.selectedTool,p=Object(c.b)({control:l,name:"scale"}),v=Object(c.b)({control:l,name:"plan"});return Object(r.useEffect)((function(){if(n.current){switch(f){case"pencil":n.current.style.cursor="crosshair";break;case"eraser":n.current.style.cursor='url("/cursors/circle.svg") 12 12, auto';break;default:return}var t,r=[],l=function(){return{strokeWidth:p*("eraser"===f?15:1.5),stroke:"pencil"===f?"#000":"#fff"}};return Re(n.current,(function(e){var n;if((!s||"touch"!==e.type)&&!("touch"===e.type&&e.touches.length>1)){a("pointerDown",!0);var c=Y(o),u=c.x+e.x*p,d=c.y+e.y*p,f=null===(n=e.touches[0])||void 0===n?void 0:n.force,v=f?Number(f.toFixed(3)):void 0;r.push({x:u,y:d,pressure:v});var h=l(),b=h.stroke,y=h.strokeWidth;t=i.drawPath({points:r,stroke:b,strokeWidth:y,groupId:"pen"})}}),(function(e){var n;if((!s||"touch"!==e.type)&&("mouse"!==e.type||e.buttons)){var c=Y(o),a=c.x+e.x*p,u=c.y+e.y*p,d=null===(n=e.touches[0])||void 0===n?void 0:n.force,f=d?Number(d.toFixed(3)):void 0;r.push({x:a,y:u,pressure:f});var v=l().strokeWidth;i.drawPath({id:t,points:r,strokeWidth:v})}}),(function(n){var o;if(!s||"touch"!==n.type){var i=l(),c=Object(wt.a)(Object(wt.a)({id:t,points:r},i),{},{groupId:"pen"});v.notes.push(c),e.add({tool:f,data:{options:c}}),t=void 0,r=[],n.touches&&0!==(null===(o=n.touches)||void 0===o?void 0:o.length)||a("pointerDown",!1)}}))}}),[p,s,d,n,e,f,o,i,v,a]),null},Fe=["title","titleId"];function Ge(){return(Ge=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Je(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Ye(t,e){var n=t.title,o=t.titleId,i=Je(t,Fe);return r.createElement("svg",Ge({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Be||(Be=r.createElement("path",{d:"M4,4C3.45,4 3,4.45 3,5V10C2.54,10 2.14,10.31 2.03,10.76V13.97H2.29C2.65,13.37 3.3,13 4,13H13C13.7,13 14.35,13.37 14.71,13.97H16.03L16,11V11C16,10.45 15.55,10 15,10H13V8C13,7.45 12.55,7 12,7C11.45,7 11,7.45 11,8V10H9V5C9,4.45 8.55,4 8,4H4M5,6H7V10L7,11H5V6M17,11V19H22V18L19,17L18,11H17M4,15C2.9,15 2,15.9 2,17C2,18.1 2.9,19 4,19H13C14.1,19 15,18.1 15,17C15,15.9 14.1,15 13,15H4Z"})))}var Ke,Ue=r.forwardRef(Ye),qe=(n.p,["title","titleId"]);function Qe(){return(Qe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function $e(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function _e(t,e){var n=t.title,o=t.titleId,i=$e(t,qe);return r.createElement("svg",Qe({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,Ke||(Ke=r.createElement("path",{d:"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})))}var tn,en=r.forwardRef(_e),nn=(n.p,["title","titleId"]);function rn(){return(rn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function on(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function ln(t,e){var n=t.title,o=t.titleId,i=on(t,nn);return r.createElement("svg",rn({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,tn||(tn=r.createElement("path",{d:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"})))}var cn,an=r.forwardRef(ln),un=(n.p,["title","titleId"]);function sn(){return(sn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function dn(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function fn(t,e){var n=t.title,o=t.titleId,i=dn(t,un);return r.createElement("svg",sn({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,cn||(cn=r.createElement("path",{d:"M12,9C10.34,9 9,10.34 9,12C9,13.66 10.34,15 12,15C13.66,15 15,13.66 15,12C15,10.34 13.66,9 12,9M12,17C9.24,17 7,14.76 7,12C7,9.24 9.24,7 12,7C14.76,7 17,9.24 17,12C17,14.76 14.76,17 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})))}var pn,vn=r.forwardRef(fn),hn=(n.p,["title","titleId"]);function bn(){return(bn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function yn(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function wn(t,e){var n=t.title,o=t.titleId,i=yn(t,hn);return r.createElement("svg",bn({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":o},i),n?r.createElement("title",{id:o},n):null,pn||(pn=r.createElement("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})))}var xn=r.forwardRef(wn);n.p,n(32);function jn(){var t=J(),e=t.control,n=t.setValue;return{selectedTool:Object(c.b)({control:e,name:"settings.selectedTool"}),setSelectedTool:Object(r.useCallback)((function(t){n("settings.selectedTool",t)}),[n])}}var gn={keyW:"wall",keyD:"destroy",keyC:"cursor",keyP:"pencil",keyQ:"pencil",keyE:"eraser",KeyM:"move"},On=function(){var t=Object(r.useState)(),e=Object(y.a)(t,2),n=e[0],o=e[1],i=jn(),l=i.selectedTool,c=i.setSelectedTool;return Object(r.useEffect)((function(){var t=function(t){var e=gn[t.code];switch(e&&c(e),t.code){case"Space":"move"!==l&&(o(l),c("move"))}};return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)}}),[l,c]),Object(r.useEffect)((function(){var t=function(t){"Space"===t.code&&n&&c(n)};return document.addEventListener("keyup",t),function(){return document.removeEventListener("keyup",t)}}),[n,c]),null},mn=function(){var t=jn(),e=t.selectedTool,n=t.setSelectedTool,r=function(t){var r=t.type,o=t.name,i=t.icon;return Object(ht.jsx)(bt,{title:o,id:"tool-".concat(r),active:e===r,onClick:function(){return n(r)},children:null!==i&&void 0!==i?i:o})};return Object(ht.jsxs)("div",{className:"toolboxContainer",children:[Object(ht.jsx)(r,{type:"wall",name:"Wall",icon:Object(ht.jsx)(qt,{})}),Object(ht.jsx)(r,{type:"destroy",name:"Destroy",icon:Object(ht.jsx)(Ue,{})}),Object(ht.jsx)(r,{type:"cursor",name:"Cursor",icon:Object(ht.jsx)(en,{})}),Object(ht.jsx)(r,{type:"pencil",name:"Pencil",icon:Object(ht.jsx)(xn,{})}),Object(ht.jsx)(r,{type:"eraser",name:"Eraser",icon:Object(ht.jsx)(an,{})}),Object(ht.jsx)(r,{type:"move",name:"Move",icon:Object(ht.jsx)(vn,{})}),Object(ht.jsx)(On,{})]})},En=function(){var t=J(),e=t.commandsHistory,n=t.interactiveRef,o=t.drawingRef,i=t.drawing,l=t.control,a=t.setValue,s=Object(c.b)({control:l,name:"settings"}),p=s.stylusMode,v=s.magneticMode,h=s.wallAlignmentMode,b=s.selectedTool,y=Object(c.b)({control:l,name:"scale"}),w=Object(c.b)({control:l,name:"plan"});return Object(r.useEffect)((function(){if(n.current&&"wall"===b){n.current.style.cursor="crosshair";return Re(n.current,(function(t){if(!p||"touch"!==t.type){if("touch"===t.type&&t.touches.length>1)return a("pointerDown",!1),void function(t){var e=w.walls.findIndex((function(e){return e.editId===t}));if(e>=0){var n=w.walls.splice(e,1);i.removeElement(I(n[0])),n[0].editId=void 0}}(t.touches[0].identifier);var e=Y(o),n=e.x+t.x*y,r=e.y+t.y*y;a("pointerDown",!0);var l=w.walls.length>0?Math.max.apply(null,w.walls.map((function(t){return parseInt(t.id)})))+1:1,c={id:"".concat(l),editId:t.id,p1:{x:n,y:r},p2:{x:n,y:r}};if(v){var u=w.walls.flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return d(t,c.p1)<=8}));u&&(c.p1.x=u.x,c.p1.y=u.y,c.p2.x=u.x,c.p2.y=u.y)}w.walls.push(c),S(i,c)}}),(function(t){if((!p||"touch"!==t.type)&&("mouse"!==t.type||t.buttons)){var e=Y(o),n=e.x+t.x*y,r=e.y+t.y*y,l=w.walls.find((function(e){return e.editId===t.id}));if(l){if(l.p2.x=n,l.p2.y=r,h){"horizontal"===u({p1:l.p1,p2:{x:n,y:r}})?l.p2.y=l.p1.y:l.p2.x=l.p1.x;var c=function(t,e){var n=u(e),r=[];return t.forEach((function(t){if(e!==t){var o=t.p1.x===t.p2.x?"vertical":t.p1.y===t.p2.y?"horizontal":"other";"horizontal"===n&&"horizontal"===o?Math.abs(e.p2.x-t.p1.x)<f?(e.p2.x=t.p1.x,r.push({wall:t,point:t.p1})):Math.abs(e.p2.x-t.p2.x)<f&&(e.p2.x=t.p2.x,r.push({wall:t,point:t.p2})):"vertical"===n&&"vertical"===o&&(Math.abs(e.p2.y-t.p1.y)<f?(e.p2.y=t.p1.y,r.push({wall:t,point:t.p1})):Math.abs(e.p2.y-t.p2.y)<f&&(e.p2.y=t.p2.y,r.push({wall:t,point:t.p2})))}})),r}(w.walls,l);A(i,l.p2,c)}V(i,l)}}}),(function(t){var n;if(!p||"touch"!==t.type){var r=w.walls.find((function(e){return e.editId===t.id}));if(r){if(v){var o=w.walls.filter((function(t){return t!==r})).flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return d(t,r.p2)<=8}));o&&(r.p2.x=o.x,r.p2.y=o.y)}T(i,r.p2),V(i,r),r.editId=void 0,e.add({tool:"wall",data:{addedWall:r}})}t.touches&&0!==(null===(n=t.touches)||void 0===n?void 0:n.length)||a("pointerDown",!1)}}))}}),[y,p,v,h,e,n,b,w.walls,o,i,a]),null};var kn=function(){var t=z(),e=t.interactiveRef,n=t.drawingRef;return console.log("App render"),Object(r.useEffect)((function(){window.addEventListener("resize",(function(){}))}),[]),Object(ht.jsx)(G.Provider,{value:t,children:Object(ht.jsxs)("main",{className:"unselectable",children:[Object(ht.jsx)(ce,{}),Object(ht.jsx)(Xe,{}),Object(ht.jsx)(En,{}),Object(ht.jsx)(De,{}),Object(ht.jsx)(ze,{}),Object(ht.jsx)(We,{}),Object(ht.jsx)(Ze,{}),Object(ht.jsx)("div",{ref:e,className:"paper main",children:Object(ht.jsxs)("svg",{ref:n,children:[Object(ht.jsx)("g",{id:"pen"}),Object(ht.jsx)("g",{id:"guide"}),Object(ht.jsx)("g",{id:"walls"})]})}),Object(ht.jsx)(mn,{}),Object(ht.jsx)(Te,{}),Object(ht.jsx)(le,{}),Object(ht.jsx)(yt,{})]})})},Ln=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,34)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,i=e.getLCP,l=e.getTTFB;n(t),r(t),o(t),i(t),l(t)}))};l.a.render(Object(ht.jsx)(kn,{}),document.getElementById("root")),Ln()}},[[33,1,2]]]);
//# sourceMappingURL=main.e76ff4d7.chunk.js.map