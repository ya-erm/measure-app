(this["webpackJsonpmeasure-app"]=this["webpackJsonpmeasure-app"]||[]).push([[0],{19:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},26:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(10),l=n.n(o),a=(n(19),n(11));n(23);function c(t,e,n){var r=document.createElement("a"),i=new Blob([t],{type:n});r.href=URL.createObjectURL(i),r.download=e,r.click(),r.remove()}function u(t,e,n,r,i,o,l,a){t.drawLine({id:e,groupId:n,x1:r,y1:i,x2:o,y2:l,strokeDashArray:a})}function s(t,e,n,r,i,o,l){t.drawRect({id:e,groupId:n,x:r-o/2,y:i-o/2,width:o,height:o,fill:l})}function d(t,e,n,r,i,o,l,a){t.drawCircle({id:e,groupId:n,x:r,y:i,rx:o,ry:o,fill:l,stroke:a})}var f=15,p=function(t){return"w".concat(t.id)},v=function(t){return"p".concat(t.editId)};function h(t,e){var n=p(e);s(t,"w".concat(e.id,"s"),n,e.p1.x,e.p1.y,10,"green")}function b(t,e){var n=t.createGroup(p(e),"walls");d(t,"w".concat(e.id,"c1"),n,e.p1.x,e.p1.y,f,"none","#000"),d(t,"w".concat(e.id,"c2"),n,e.p2.x,e.p2.y,f,"none","#000"),u(t,"w".concat(e.id,"l"),n,e.p1.x,e.p1.y,e.p2.x,e.p2.y),h(t,e),function(t,e){var n=p(e);s(t,"w".concat(e.id,"e"),n,e.p2.x,e.p2.y,10,"red")}(t,e)}function g(t,e,n){var r=t.createGroup(v(e),"guide"),i=n.map((function(n){var i="p".concat(e.editId,"g").concat(n.wall.id);return u(t,i,r,e.x,e.y,n.point.x,n.point.y,"10 10"),i}));t.removeElements((function(t){return!i.includes(t.id)}),r)}function w(t,e){t.removeElement(v(e),"guide")}var y=n(3),x=n(6),m=n(14),j=n(9);function O(t){if(!t.length)return"";var e=t.reduce((function(t,e,n,r){var i=Object(x.a)(e,2),o=i[0],l=i[1],a=Object(x.a)(r[(n+1)%r.length],2),c=a[0],u=a[1];return t.push(o,l,(o+c)/2,(l+u)/2),t}),["M"].concat(Object(j.a)(t[0]),["Q"]));return e.push("Z"),e.join(" ")}var E="http://www.w3.org/2000/svg",k=0;function S(t,e){var n=e.x1,r=e.x2,i=e.y1,o=e.y2,l=e.strokeWidth,a=e.stroke,c=void 0===a?"#000":a,u=e.strokeDashArray;t.setAttribute("x1",n.toString()),t.setAttribute("y1",i.toString()),t.setAttribute("x2",r.toString()),t.setAttribute("y2",o.toString()),t.setAttribute("stroke",c),l&&t.setAttribute("stroke-width",l.toString()),u&&t.setAttribute("stroke-dasharray",u)}function I(t,e){var n=e.x,r=e.y,i=e.width,o=e.height,l=e.strokeWidth,a=e.stroke,c=e.fill;t.setAttribute("x",n.toString()),t.setAttribute("y",r.toString()),t.setAttribute("width",i.toString()),t.setAttribute("height",o.toString()),c&&t.setAttribute("fill",c),a&&t.setAttribute("stroke",a),l&&t.setAttribute("stroke-width",l.toString())}function M(t,e){var n=e.x,r=e.y,i=e.rx,o=e.ry,l=e.strokeWidth,a=e.stroke,c=e.fill;t.setAttribute("cx",n.toString()),t.setAttribute("cy",r.toString()),t.setAttribute("rx",i.toString()),t.setAttribute("ry",o.toString()),c&&t.setAttribute("fill",c),a&&t.setAttribute("stroke",a),l&&t.setAttribute("stroke-width",l.toString())}function C(t,e,n,r){var i=e?null===t||void 0===t?void 0:t.getElementById(e):void 0,o=null!==e&&void 0!==e?e:"e".concat(k++);if(!i){(i=document.createElementNS(E,n)).setAttribute("id",o);var l=r?null===t||void 0===t?void 0:t.getElementById(r):t;null===l||void 0===l||l.appendChild(i)}return{element:i,id:o}}var L=[],A=[];function P(t){localStorage.setItem("plan",JSON.stringify(t))}function H(t){var e={walls:[]};try{if(!t)return e;var n=JSON.parse(t);return console.log("Restored plan",n),n}catch(r){console.log("Failed to restore plan")}return e}function R(){var t=Object(r.useMemo)((function(){return{scale:2,selectedTool:"wall",pointerDown:!1,stylusMode:!0,magneticMode:!0,wallAlignmentMode:!0,plan:H(localStorage.getItem("plan"))}}),[]),e=Object(r.useState)(t),n=Object(x.a)(e,2),i=n[0],o=n[1],l=Object(r.useCallback)((function(t){return o((function(e){return Object(y.a)(Object(y.a)({},e),t)}))}),[]),a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=Object(r.useRef)(null);return Object(r.useEffect)((function(){var n=e.current,r=null===n||void 0===n?void 0:n.parentElement;if(n&&r){var i=r.getBoundingClientRect(),o=i.width,l=i.height;n.setAttribute("viewBox","0 0 ".concat(o*t," ").concat(l*t)),n.setAttribute("version","1.1"),n.setAttribute("xmlns",E),n.setAttribute("width","".concat(o*t)),n.setAttribute("height","".concat(l*t))}}),[t,e]),{svgRef:e,drawing:{drawLine:function(t){var n=C(e.current,t.id,"line",t.groupId),r=n.element,i=n.id;return S(r,t),i},drawCircle:function(t){var n=C(e.current,t.id,"ellipse",t.groupId),r=n.element,i=n.id;return M(r,t),i},drawRect:function(t){var n=C(e.current,t.id,"rect",t.groupId),r=n.element,i=n.id;return I(r,t),i},createGroup:function(t,n){return C(e.current,t,"g",n).id},removeElement:function(t,n){var r,i=n?null===(r=e.current)||void 0===r?void 0:r.getElementById(n):e.current,o=null===i||void 0===i?void 0:i.querySelector("#".concat(t));null===o||void 0===o||o.remove()},removeElements:function(t,n){var r,i,o=n?null===(r=e.current)||void 0===r?void 0:r.getElementById(n):e.current;null===o||void 0===o||null===(i=o.childNodes)||void 0===i||i.forEach((function(e){t(e)&&e.remove()}))},drawPath:function(t){var n=t.id,r=t.points,i=t.groupId,o=C(e.current,n,"path",i),l=o.element,a=o.id;return t.stroke&&l.setAttribute("fill",t.stroke),l.setAttribute("d",O(Object(m.a)(r,{size:t.strokeWidth,smoothing:.5,thinning:.5}))),a}}}}(i.scale),c=a.svgRef,u=a.drawing,s=function(t,e){return Object(r.useMemo)((function(){return{add:function(t){L.push(t),A=[],P(e)},undo:function(){var n=L.pop();if(n)switch(A.push(n),n.tool){case"wall":var r=(null===n||void 0===n?void 0:n.data).addedWall;e.walls=e.walls.filter((function(t){return t!==r})),t.removeElement(p(r));break;case"cursor":n.data.before.forEach((function(n){e.walls.filter((function(t){return t.id===n.id})).forEach((function(t){t.p1=n.p1,t.p2=n.p2})),b(t,n)}));break;case"pencil":case"eraser":var i=n.data.options;i.id&&t.removeElement(i.id)}},redo:function(){var n=A.pop();if(n)switch(L.push(n),n.tool){case"wall":var r=(null===n||void 0===n?void 0:n.data).addedWall;e.walls.push(r),b(t,r);break;case"cursor":n.data.after.forEach((function(n){e.walls.filter((function(t){return t.id===n.id})).forEach((function(t){t.p1=n.p1,t.p2=n.p2})),b(t,n)}));break;case"pencil":case"eraser":var i=n.data.options;t.drawPath(i)}}}}),[e,t])}(u,i.plan);Object(r.useEffect)((function(){var e;null===(e=t.plan)||void 0===e||e.walls.forEach((function(t){return b(u,t)}))}),[u,t]);var d=Object(r.useRef)(null);return{drawing:u,drawingRef:c,interactiveRef:d,globalState:i,setGlobalState:o,updateGlobalState:l,commandsHistory:s}}var V,D=i.a.createContext(null),T=function(){var t=i.a.useContext(D);if(null===t)throw new Error("useGlobalContext must be used within an GlobalContext.Provider");return t},N=(n(24),n(1)),B=function(){var t=T(),e=t.drawing,n=t.drawingRef,i=t.globalState,o=Object(r.useCallback)((function(){return function(t){var e=t.cloneNode(!0),n=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),r=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",n);r.replaceChild(e,r.documentElement),c((new XMLSerializer).serializeToString(r).replace(/></g,">\n\r<"),"Plan ".concat((new Date).toLocaleDateString(),".svg"),"image/svg+xml")}(n.current)}),[n]),l=Object(r.useCallback)((function(){c(JSON.stringify(i.plan),"Plan ".concat((new Date).toLocaleDateString(),".json"),"text/plain")}),[i.plan]),a=Object(r.useCallback)((function(){!function(t){var e=document.createElement("input");e.type="file",e.onchange=function(n){if(e.files&&0!==e.files.length){var r=e.files[0],i=new FileReader;i.readAsText(r,"UTF-8"),i.onload=function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r)}}},e.click()}((function(t){try{if(!t)return;var n=JSON.parse(t);console.log("Loaded plan",n),i.plan=n,i.plan.walls.forEach((function(t){return b(e,t)}))}catch(r){console.log("Failed to load plan")}}))}),[e,i]);return Object(N.jsxs)("div",{className:"fileActionsContainer",children:[Object(N.jsx)("button",{onClick:o,children:"Save SVG"}),Object(N.jsx)("button",{onClick:l,children:"Save JSON"}),Object(N.jsx)("button",{onClick:a,children:"Load JSON"})]})},G=["title","titleId"];function X(){return(X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function W(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function F(t,e){var n=t.title,i=t.titleId,o=W(t,G);return r.createElement("svg",X({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,V||(V=r.createElement("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19C6,20.1 6.9,21 8,21H16C17.1,21 18,20.1 18,19V7H6V19Z"})))}var z,J=r.forwardRef(F),Y=(n.p,["title","titleId"]);function Z(){return(Z=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function U(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function q(t,e){var n=t.title,i=t.titleId,o=U(t,Y);return r.createElement("svg",Z({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,z||(z=r.createElement("path",{d:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"})))}var Q,_=r.forwardRef(q),K=(n.p,["title","titleId"]);function $(){return($=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function tt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function et(t,e){var n=t.title,i=t.titleId,o=tt(t,K);return r.createElement("svg",$({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,Q||(Q=r.createElement("path",{d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})))}var nt=r.forwardRef(et),rt=(n.p,n(8)),it=(n(26),function(t){var e=t.icon,n=t.title,r=t.className,i=t.children,o=t.onClick;return Object(N.jsxs)("div",{title:n,className:Object(rt.a)("roundButton",r),onClick:o,children:[e,i]})}),ot=(n(27),function(t){var e=t.history,n=t.drawing,r=t.plan;return Object(N.jsxs)("div",{className:"historyPanel",children:[Object(N.jsx)(it,{title:"Undo",onClick:e.undo,icon:Object(N.jsx)(nt,{})}),Object(N.jsx)(it,{title:"Redo",onClick:e.redo,icon:Object(N.jsx)(_,{})}),Object(N.jsx)(it,{title:"Clear",onClick:function(){confirm("Are you sure want to delete all?")&&(r.walls.forEach((function(t){return n.removeElement(p(t))})),r.walls=[],P(r))},icon:Object(N.jsx)(J,{})})]})}),lt=(n(28),function(){var t=T(),e=t.globalState,n=e.stylusMode,r=e.magneticMode,i=e.wallAlignmentMode,o=t.updateGlobalState;return Object(N.jsxs)("div",{className:"settingsList",children:[Object(N.jsx)("div",{children:Object(N.jsx)("b",{children:"Settings"})}),Object(N.jsx)("div",{children:Object(N.jsxs)("label",{children:[Object(N.jsx)("input",{type:"checkbox",checked:null!==n&&void 0!==n&&n,onChange:function(t){return o({stylusMode:t.target.checked})}}),"Stylus mode"]})}),Object(N.jsx)("div",{children:Object(N.jsxs)("label",{children:[Object(N.jsx)("input",{type:"checkbox",checked:null!==i&&void 0!==i&&i,onChange:function(t){return o({wallAlignmentMode:t.target.checked})}}),"Walls alignment"]})}),Object(N.jsx)("div",{children:Object(N.jsxs)("label",{children:[Object(N.jsx)("input",{type:"checkbox",checked:null!==r&&void 0!==r&&r,onChange:function(t){return o({magneticMode:t.target.checked})}}),"Magnet mode"]})}),Object(N.jsx)("a",{href:"https://perfect-freehand-example.vercel.app/",target:"_blank",rel:"noreferrer",children:"Perfect freehand"})]})});function at(t){var e=t.p1,n=t.p2,r=n.x-e.x,i=n.y-e.y;return Math.abs(r)>Math.abs(i)?"horizontal":"vertical"}function ct(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}var ut=20;function st(t,e,n,r){function i(t){return{id:1,x:t.pageX,y:t.pageY,type:"mouse",buttons:t.buttons,changedTouches:[{identifier:1,pageX:t.pageX,pageY:t.pageY}]}}var o=function(t){return e(i(t))},l=function(t){return n(i(t))},a=function(t){return r(i(t))};function c(t){var e=t.changedTouches[0];return{id:e.identifier,x:e.pageX,y:e.pageY,touches:Array.from(t.touches),changedTouches:Array.from(t.changedTouches),type:"stylus"===e.touchType?"stylus":"touch"}}var u=function(t){return e(c(t))},s=function(t){return n(c(t))},d=function(t){return r(c(t))};return t.addEventListener("mousedown",o),t.addEventListener("mousemove",l),t.addEventListener("mouseup",a),t.addEventListener("touchstart",u),t.addEventListener("touchmove",s),t.addEventListener("touchend",d),function(){t.removeEventListener("mousedown",o),t.removeEventListener("mousemove",l),t.removeEventListener("mouseup",a),t.removeEventListener("touchstart",u),t.removeEventListener("touchmove",s),t.removeEventListener("touchend",d)}}function dt(t){return t.filter((function(t){return t.p1.editId||t.p2.editId})).map((function(t){return{id:t.id,p1:{x:t.p1.x,y:t.p1.y},p2:{x:t.p2.x,y:t.p2.y}}}))}var ft,pt=function(){var t=T(),e=t.commandsHistory,n=t.interactiveRef,i=t.drawing,o=t.globalState,l=t.updateGlobalState,a=o.scale,c=o.stylusMode,u=o.magneticMode,s=o.selectedTool,d=o.plan;return Object(r.useEffect)((function(){if(n.current&&"cursor"===s){var t=[];return st(n.current,(function(e){var n;c&&"touch"===e.type||(l({pointerDown:!0}),null===(n=e.changedTouches)||void 0===n||n.forEach((function(e){var n=e.identifier,r=e.pageX*a,i=e.pageY*a;d.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return ct(t,{x:r,y:i})<=f})).forEach((function(t){t.editId=n})),t=dt(d.walls)})))}),(function(t){var e;("mouse"!==t.type||t.buttons)&&(null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,n=t.pageX*a,r=t.pageY*a,o=d.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e}));if(o.forEach((function(t){t.x=n,t.y=r})),u&&o.length>0){var l=function(t,e,n){var r=[];return t.forEach((function(t){Math.abs(t.p1.x-n.x)<ut&&(r.push({wall:t,point:t.p1}),e.forEach((function(e){e.x=t.p1.x}))),Math.abs(t.p1.y-n.y)<ut&&(r.push({wall:t,point:t.p1}),e.forEach((function(e){e.y=t.p1.y}))),Math.abs(t.p2.x-n.x)<ut&&(r.push({wall:t,point:t.p2}),e.forEach((function(e){e.x=t.p2.x}))),Math.abs(t.p2.y-n.y)<ut&&(r.push({wall:t,point:t.p2}),e.forEach((function(e){e.y=t.p2.y})))})),r}(d.walls,o,{x:n,y:r});g(i,o[0],l)}d.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){return b(i,t)}))})))}),(function(n){var r,o;null===(r=n.changedTouches)||void 0===r||r.forEach((function(n){var r=n.identifier;d.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===r})).forEach((function(t){if(u){var e=d.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(e){return e!==t})).find((function(e){return ct(e,t)<=f}));e&&(t.x=e.x,t.y=e.y)}})),d.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){t.p1.editId=void 0,t.p2.editId=void 0,b(i,t)})),w(i,{editId:r,x:0,y:0}),e.add({tool:"cursor",data:{before:t,after:dt(d.walls)}})})),0===(null===(o=n.touches)||void 0===o?void 0:o.length)&&l({pointerDown:!1})}))}}),[n.current,a,c,u,s]),null},vt=["pencil","eraser"],ht=function(){var t=T(),e=t.commandsHistory,n=t.drawing,i=t.interactiveRef,o=t.globalState,l=t.updateGlobalState,a=o.scale,c=o.stylusMode,u=o.magneticMode,s=o.selectedTool;return Object(r.useEffect)((function(){if(i.current&&vt.includes(s)){var t,r=[],o=function(){return{strokeWidth:a*("eraser"===s?15:1.5),stroke:"pencil"===s?"#000":"#fff"}};return st(i.current,(function(e){var i,u,s;if((!c||"touch"!==e.type)&&!("touch"===e.type&&e.touches.length>1)){l({pointerDown:!0});var d=e.touches&&e.touches[0],f=(null!==(i=null===d||void 0===d?void 0:d.pageX)&&void 0!==i?i:e.x)*a,p=(null!==(u=null===d||void 0===d?void 0:d.pageY)&&void 0!==u?u:e.y)*a;r.push({x:f,y:p,pressure:null!==(s=null===d||void 0===d?void 0:d.force)&&void 0!==s?s:.5});var v=o(),h=v.stroke,b=v.strokeWidth;t=n.drawPath({points:r,stroke:h,strokeWidth:b,groupId:"pen"})}}),(function(e){var i,l,u;if((!c||"touch"!==e.type)&&("mouse"!==e.type||e.buttons)){var s=e.touches&&e.touches[0],d=(null!==(i=null===s||void 0===s?void 0:s.pageX)&&void 0!==i?i:e.x)*a,f=(null!==(l=null===s||void 0===s?void 0:s.pageY)&&void 0!==l?l:e.y)*a;r.push({x:d,y:f,pressure:null!==(u=null===s||void 0===s?void 0:s.force)&&void 0!==u?u:.5});var p=o().strokeWidth;n.drawPath({id:t,points:r,strokeWidth:p})}}),(function(n){var i=o();e.add({tool:s,data:{options:Object(y.a)(Object(y.a)({id:t,points:r},i),{},{groupId:"pen"})}}),t=void 0,r=[],n.touches&&0!==n.touches.length||l({pointerDown:!1})}))}}),[i.current,a,c,u,s]),null},bt=["title","titleId"];function gt(){return(gt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function wt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function yt(t,e){var n=t.title,i=t.titleId,o=wt(t,bt);return r.createElement("svg",gt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,ft||(ft=r.createElement("path",{d:"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})))}var xt,mt=r.forwardRef(yt),jt=(n.p,["title","titleId"]);function Ot(){return(Ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Et(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function kt(t,e){var n=t.title,i=t.titleId,o=Et(t,jt);return r.createElement("svg",Ot({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,xt||(xt=r.createElement("path",{d:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"})))}var St,It=r.forwardRef(kt),Mt=(n.p,["title","titleId"]);function Ct(){return(Ct=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Lt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function At(t,e){var n=t.title,i=t.titleId,o=Lt(t,Mt);return r.createElement("svg",Ct({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,St||(St=r.createElement("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})))}var Pt,Ht=r.forwardRef(At),Rt=(n.p,["title","titleId"]);function Vt(){return(Vt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Dt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Tt(t,e){var n=t.title,i=t.titleId,o=Dt(t,Rt);return r.createElement("svg",Vt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,Pt||(Pt=r.createElement("path",{d:"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z"})))}var Nt=r.forwardRef(Tt),Bt=(n.p,n(29),function(){var t=T(),e=t.globalState.selectedTool,n=t.updateGlobalState,r=function(t){var r=t.type,i=t.name,o=t.icon;return Object(N.jsx)(it,{title:i,onClick:function(){n({selectedTool:r})},className:Object(rt.a)(e===r&&"toolboxSelectedItem"),children:null!==o&&void 0!==o?o:i})};return Object(N.jsxs)("div",{className:"toolboxContainer",children:[Object(N.jsx)(r,{type:"wall",name:"Wall",icon:Object(N.jsx)(Nt,{})}),Object(N.jsx)(r,{type:"cursor",name:"Cursor",icon:Object(N.jsx)(mt,{})}),Object(N.jsx)(r,{type:"pencil",name:"Pencil",icon:Object(N.jsx)(Ht,{})}),Object(N.jsx)(r,{type:"eraser",name:"Eraser",icon:Object(N.jsx)(It,{})})]})}),Gt=function(){var t=T(),e=t.commandsHistory,n=t.interactiveRef,i=t.drawing,o=t.globalState,l=t.updateGlobalState,a=o.scale,c=o.stylusMode,u=o.magneticMode,s=o.wallAlignmentMode,d=o.selectedTool,v=o.plan;return Object(r.useEffect)((function(){if(n.current&&"wall"===d){return st(n.current,(function(t){var e=t.x*a,n=t.y*a;if(!c||"touch"!==t.type)if("touch"===t.type&&t.touches.length>1)!function(t){var e=v.walls.findIndex((function(e){return e.editId===t}));if(e>=0){var n=v.walls.splice(e,1);i.removeElement(p(n[0]))}}(t.id);else{l({pointerDown:!0});var r=v.walls.length>0?Math.max.apply(null,v.walls.map((function(t){return parseInt(t.id)})))+1:1,o={id:"".concat(r),editId:t.id,p1:{x:e,y:n},p2:{x:e,y:n}};if(u){var s=v.walls.flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return ct(t,o.p1)<=f}));s&&(o.p1.x=s.x,o.p1.y=s.y,o.p2.x=s.x,o.p2.y=s.y)}v.walls.push(o),h(i,o)}}),(function(t){if("mouse"!==t.type||t.buttons){var e=t.x*a,n=t.y*a,r=v.walls.find((function(e){return e.editId===t.id}));if(r){if(r.p2.x=e,r.p2.y=n,s){"horizontal"===at({p1:r.p1,p2:{x:e,y:n}})?r.p2.y=r.p1.y:r.p2.x=r.p1.x;var o=function(t,e){var n=at(e),r=[];return t.forEach((function(t){if(e!==t){var i=t.p1.x===t.p2.x?"vertical":t.p1.y===t.p2.y?"horizontal":"other";"horizontal"===n&&"horizontal"===i?Math.abs(e.p2.x-t.p1.x)<ut?(e.p2.x=t.p1.x,r.push({wall:t,point:t.p1})):Math.abs(e.p2.x-t.p2.x)<ut&&(e.p2.x=t.p2.x,r.push({wall:t,point:t.p2})):"vertical"===n&&"vertical"===i&&(Math.abs(e.p2.y-t.p1.y)<ut?(e.p2.y=t.p1.y,r.push({wall:t,point:t.p1})):Math.abs(e.p2.y-t.p2.y)<ut&&(e.p2.y=t.p2.y,r.push({wall:t,point:t.p2})))}})),r}(v.walls,r);g(i,r.p2,o)}b(i,r)}}}),(function(t){var n=t.id,r=t.touches,o=v.walls.find((function(t){return t.editId===n}));if(o){if(u){var a=v.walls.filter((function(t){return t!==o})).flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return ct(t,o.p2)<=f}));a&&(o.p2.x=a.x,o.p2.y=a.y)}w(i,o.p2),b(i,o),o.editId=void 0,e.add({tool:"wall",data:{addedWall:o}})}0===(null===r||void 0===r?void 0:r.length)&&l({pointerDown:!1})}))}}),[n.current,c,u,s,d]),null};var Xt=function(){var t=R(),e=t.commandsHistory,n=t.interactiveRef,i=t.drawing,o=t.drawingRef,l=t.globalState,c=l.pointerDown;return Object(r.useEffect)((function(){var t=function(t){c&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),function(){document.removeEventListener("touchmove",t)}}),[c]),Object(N.jsx)(D.Provider,{value:t,children:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(a.a,{children:Object(N.jsx)("title",{children:"Measure App"})}),Object(N.jsxs)("main",{children:[Object(N.jsx)(Gt,{}),Object(N.jsx)(pt,{}),Object(N.jsx)(ht,{}),Object(N.jsx)("div",{ref:n,className:"paper main",children:Object(N.jsxs)("svg",{ref:o,style:{width:"100%",height:"100%"},children:[Object(N.jsx)("g",{id:"pen"}),Object(N.jsx)("g",{id:"guide"}),Object(N.jsx)("g",{id:"walls"})]})}),Object(N.jsx)(Bt,{}),Object(N.jsxs)("div",{className:"rightMenu",children:[Object(N.jsx)(lt,{}),Object(N.jsx)(B,{})]}),Object(N.jsx)(ot,{history:e,plan:l.plan,drawing:i})]})]})})},Wt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,31)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,l=e.getTTFB;n(t),r(t),i(t),o(t),l(t)}))};l.a.render(Object(N.jsx)(Xt,{}),document.getElementById("root")),Wt()}},[[30,1,2]]]);
//# sourceMappingURL=main.51e299b6.chunk.js.map