{"version":3,"sources":["utils/svg/svg.ts","utils/svg/convert.ts","hooks/useDrawing.ts","components/GlobalContext.tsx","components/Settings/Settings.tsx","components/Draw.ts","components/Geometry.ts","components/Tools/ToolEvent.ts","components/Tools/CursorTool.tsx","assets/icons/cursor.svg","components/Tools/PenTool.tsx","assets/icons/eraser.svg","assets/icons/pencil.svg","assets/icons/wall.svg","components/Tools/Toolbox.tsx","components/Tools/WallTool.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Point","x","y","this","value","Math","sqrt","pow","angle","atan2","Vector","r","p","COMMAND_TYPE","Command","type","length","slice","po","splice","xy","undefined","map","v","num","digits","toFixed","roundUp","join","a","cos","sin","Convert","ratio","pr","st","ne","prev","start","vector","sub","toVector","scale","toPoint","add","p1","p2","p3","p4","_controlPoint","points","i","commands","lineCommands","push","bezierCurve","SVG_NS","IID","findOrCreate","svg","key","groupId","element","getElementById","id","document","createElementNS","setAttribute","dest","appendChild","useGlobalState","useState","selectedTool","pointerDown","stylusMode","magneticMode","wallAlignmentMode","plan","walls","globalState","setGlobalState","updateGlobalState","useCallback","update","interactiveRef","useRef","svgRef","useEffect","current","parentElement","getBoundingClientRect","width","height","toString","drawing","drawLine","options","line","x1","x2","y1","y2","strokeWidth","stroke","setLineOptions","drawCircle","ellipse","rx","ry","fill","setCircleOptions","drawRect","setRectOptions","createGroup","parentId","removeElement","remove","drawPath","path","strokeLinecap","close","setPathOptions","bezierCurveCommands","c","useDrawing","drawingRef","GlobalContext","React","createContext","useGlobalContext","context","useContext","Error","Settings","className","checked","onChange","e","target","drawSquare","ctx","xc","yc","size","radius","wallCircleRadius","wallGroupId","wall","drawWallStart","gid","drawWallEnd","drawWall","distanceBetween","registerTool","onStart","onMove","onEnd","mouseToToolEvent","pageX","pageY","buttons","changedTouches","identifier","onMouseDown","onMouseMove","onMouseUp","touchToToolEvent","touch","touches","Array","from","touchType","onTouchStart","onTouchMove","onTouchEnd","addEventListener","removeEventListener","_path","CursorTool","forEach","flatMap","item","filter","editId","w","closePoint","o","find","tools","PenTool","includes","lineWidth","log","force","_excluded","_extends","Object","assign","arguments","source","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgCursor","_ref","title","titleId","props","xmlns","xmlnsXlink","viewBox","ref","d","ForwardRef","SvgEraser","SvgPencil","SvgWall","Toolbox","ToolBoxItem","name","icon","onClick","clsx","WallTool","redrawEditingLines","console","wallIndex","findIndex","cancel","dx","dy","abs","getWallOrientation","App","globalContext","preventDefault","passive","Provider","Helmet","mask","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.31b5ed71.chunk.js","sourcesContent":["const roundUp = (num: number, digits = 2): number => +num.toFixed(digits);\n\nexport class Point {\n    public x: number;\n    public y: number;\n    constructor(x: number, y: number) {\n        this.x = x;\n        this.y = y;\n    }\n\n    public toVector(): Vector {\n        const value = Math.sqrt(Math.pow(this.x, 2.0) + Math.pow(this.y, 2.0));\n        const angle = Math.atan2(this.y, this.x);\n        return new Vector(value, angle);\n    }\n\n    public scale(r: number): Point {\n        return new Point(this.x * r, this.y * r);\n    }\n\n    public add(p: Point): Point {\n        return new Point(this.x + p.x, this.y + p.y);\n    }\n\n    public sub(p: Point): Point {\n        return new Point(this.x - p.x, this.y - p.y);\n    }\n\n    public eql(p: Point): boolean {\n        return this.x === p.x && this.y === p.y;\n    }\n\n    public clone(): Point {\n        return new Point(this.x, this.y);\n    }\n}\n\nexport type CommandType =\n    | 'M'\n    | 'm'\n    | 'L'\n    | 'l'\n    | 'C'\n    | 'c'\n    | 'Z'\n    | 'H'\n    | 'h'\n    | 'V'\n    | 'v'\n    | 'A'\n    | 'a'\n    | 'Q'\n    | 'q';\nexport type CommandObject = {\n    type: CommandType;\n    value: number[];\n};\n\nexport const COMMAND_TYPE: { [name: string]: CommandType } = {\n    MOVE: 'M', // M 0 0\n    MOVE_RELATIVE: 'm', // m 0 0\n    LINE: 'L', // L 1 1\n    LINE_RELATIVE: 'l', // l 1 1\n    CURVE: 'C', // C 1 1 2 2 3 3\n    CURVE_RELATIVE: 'c', // c 1 1 2 2 3 3\n    CLOSE: 'Z', // Z, z\n    HORIZONTAL: 'H', // H 10\n    HORIZONTAL_RELATIVE: 'h', // h 10\n    VERTICAL: 'V', // V 20\n    VERTICAL_RELATIVE: 'v', // v 20\n    ARC_CURVE: 'A', // A 6 4 10 0 1 14 10\n    ARC_CURVE_RELATIVE: 'a', // A 6 4 10 0 1 14 10\n    QUADRATIC_CURVE: 'Q', // Q 10 60 10 30\n    QUADRATIC_CURVE_RELATIVE: 'q', // q 10 60 10 30\n} as const;\n\n// TODO: compatible COMMAND_TYPE\nexport class Command {\n    public type: CommandType;\n    public value: number[];\n    // TODO: Convert data format to number array.\n    constructor(type: CommandType, value: number[] = []) {\n        this.value = value;\n        this.type = type;\n    }\n\n    public set cr(po: Point | undefined) {\n        if (!po) return;\n        if ((this.type !== 'C' && this.type !== 'c') || this.value.length !== 6) {\n            return;\n        }\n        this.value.splice(2, 1, po.x);\n        this.value.splice(3, 1, po.y);\n    }\n    public get cr(): Point | undefined {\n        if ((this.type !== 'C' && this.type !== 'c') || this.value.length !== 6) {\n            return undefined;\n        }\n        const [x, y] = this.value.slice(2, 4);\n        return new Point(x, y);\n    }\n    public set cl(po: Point | undefined) {\n        if (!po) return;\n        if ((this.type !== 'C' && this.type !== 'c') || this.value.length !== 6) {\n            return;\n        }\n        this.value.splice(0, 1, po.x);\n        this.value.splice(1, 1, po.y);\n    }\n    public get cl(): Point | undefined {\n        if ((this.type !== 'C' && this.type !== 'c') || this.value.length !== 6) {\n            return undefined;\n        }\n        const [x, y] = this.value.slice(0, 2);\n        return new Point(x, y);\n    }\n\n    public set point(po: Point | undefined) {\n        if (!po) return;\n        this.value.splice(this.value.length - 2, 1, po.x);\n        this.value.splice(this.value.length - 1, 1, po.y);\n    }\n    public get point(): Point | undefined {\n        const xy = this.value.slice(this.value.length - 2);\n        return xy.length === 2 ? new Point(xy[0], xy[1]) : undefined;\n    }\n\n    public toString(): string {\n        if (this.type === COMMAND_TYPE.CLOSE) return COMMAND_TYPE.CLOSE;\n        return `${this.type} ${this.value.map((v) => roundUp(v)).join(' ')}`;\n    }\n\n    public scale(r: number): Command {\n        const upd = new Command(\n            this.type,\n            this.value.map((p) => p * r),\n        );\n        return upd;\n    }\n\n    public clone(): Command {\n        return new Command(this.type, this.value.slice());\n    }\n}\n\nexport class Vector {\n    public angle: number;\n    public value: number;\n    constructor(v: number, a: number) {\n        this.value = v;\n        this.angle = a;\n    }\n\n    public toPoint(): Point {\n        const x = Math.cos(this.angle) * this.value;\n        const y = Math.sin(this.angle) * this.value;\n        return new Point(x, y);\n    }\n\n    public scale(r: number): Vector {\n        return new Vector(this.value * r, this.angle);\n    }\n}\n","import { Point, Command, COMMAND_TYPE } from './svg';\n\nexport type PointObject = {\n    x: number;\n    y: number;\n    pressure?: number;\n};\n\nexport type ConvertOption = {\n    ratio?: number;\n};\n\nexport class Convert {\n    public ratio: number;\n    constructor({ ratio }: ConvertOption = {}) {\n        this.ratio = ratio ?? 0.2;\n    }\n    private _controlPoint(pr: PointObject, st: PointObject, ne: PointObject): [number, number] {\n        const prev = new Point(pr.x, pr.y);\n        const start = new Point(st.x, st.y);\n        const next = new Point(ne.x, ne.y);\n        const vector = next.sub(prev).toVector().scale(this.ratio).toPoint();\n        const po = start.add(vector);\n        return [po.x, po.y];\n    }\n\n    public bezierCurve(\n        p1: PointObject,\n        p2: PointObject,\n        p3: PointObject,\n        p4: PointObject,\n    ): Command {\n        const value = [\n            ...this._controlPoint(p1, p2, p3),\n            ...this._controlPoint(p4, p3, p2),\n            p3.x,\n            p3.y,\n        ];\n        return new Command(COMMAND_TYPE.CURVE, value);\n    }\n\n    public lineCommands(points: PointObject[]): Command[] {\n        return points.map(\n            (p, i) => new Command(i === 0 ? COMMAND_TYPE.MOVE : COMMAND_TYPE.LINE, [p.x, p.y]),\n        );\n    }\n\n    public bezierCurveCommands(p: PointObject[]): Command[] {\n        const commands: Command[] = [];\n        if (p.length < 3) {\n            return this.lineCommands(p);\n        }\n        for (let i = 0; i < p.length; i += 1) {\n            if (i === 0) {\n                commands.push(new Command(COMMAND_TYPE.MOVE, [p[i].x, p[i].y]));\n                continue;\n            }\n            commands.push(\n                this.bezierCurve(\n                    p[i - 2 < 0 ? 0 : i - 2],\n                    p[i - 1],\n                    p[i],\n                    i < p.length - 1 ? p[i + 1] : p[i],\n                ),\n            );\n        }\n        return commands;\n    }\n}\n","import React, { useEffect, useRef } from 'react';\nimport { Convert, PointObject } from '../utils/svg/convert';\n\ntype IDrawIdOptions = {\n    id?: string;\n    groupId?: string;\n};\n\ntype IDrawStrokeOptions = {\n    stroke?: string;\n    strokeWidth?: number;\n};\ntype IDrawShapeOptions = {\n    fill?: string;\n} & IDrawStrokeOptions;\n\ntype IDrawLineOptions = {\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n} & IDrawStrokeOptions &\n    IDrawIdOptions;\n\ntype IDrawRectOptions = {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n} & IDrawShapeOptions &\n    IDrawIdOptions;\n\ntype IDrawCircleOptions = {\n    x: number;\n    y: number;\n    rx: number;\n    ry: number;\n} & IDrawShapeOptions &\n    IDrawIdOptions;\n\ntype IDrawPathOptions = {\n    points: Array<PointObject>;\n    strokeLinecap?: 'butt' | 'round' | 'square';\n    close?: boolean;\n} & IDrawShapeOptions &\n    IDrawIdOptions;\n\nexport type IDrawing = {\n    createGroup: (id?: string, groupId?: string) => string;\n    drawLine: (options: IDrawLineOptions) => string;\n    drawCircle: (options: IDrawCircleOptions) => string;\n    drawRect: (options: IDrawRectOptions) => string;\n    drawPath: (options: IDrawPathOptions) => string;\n    removeElement: (id: string) => void;\n};\n\ntype UseDrawingReturn = {\n    svgRef: React.RefObject<SVGSVGElement>;\n    drawing: IDrawing;\n};\n\nconst SVG_NS = 'http://www.w3.org/2000/svg';\n\nlet IID = 0;\n\nfunction setLineOptions(line: Element, options: IDrawLineOptions) {\n    const { x1, x2, y1, y2, strokeWidth, stroke = '#000' } = options;\n    line.setAttribute('x1', x1.toString());\n    line.setAttribute('y1', y1.toString());\n    line.setAttribute('x2', x2.toString());\n    line.setAttribute('y2', y2.toString());\n    line.setAttribute('stroke', stroke);\n    if (strokeWidth) line.setAttribute('stroke-width', strokeWidth.toString());\n}\n\nfunction setRectOptions(ellipse: Element, options: IDrawRectOptions) {\n    const { x, y, width, height, strokeWidth, stroke, fill } = options;\n    ellipse.setAttribute('x', x.toString());\n    ellipse.setAttribute('y', y.toString());\n    ellipse.setAttribute('width', width.toString());\n    ellipse.setAttribute('height', height.toString());\n    if (fill) ellipse.setAttribute('fill', fill);\n    if (stroke) ellipse.setAttribute('stroke', stroke);\n    if (strokeWidth) ellipse.setAttribute('stroke-width', strokeWidth.toString());\n}\n\nfunction setCircleOptions(ellipse: Element, options: IDrawCircleOptions) {\n    const { x, y, rx, ry, strokeWidth, stroke, fill } = options;\n    ellipse.setAttribute('cx', x.toString());\n    ellipse.setAttribute('cy', y.toString());\n    ellipse.setAttribute('rx', rx.toString());\n    ellipse.setAttribute('ry', ry.toString());\n    if (fill) ellipse.setAttribute('fill', fill);\n    if (stroke) ellipse.setAttribute('stroke', stroke);\n    if (strokeWidth) ellipse.setAttribute('stroke-width', strokeWidth.toString());\n}\n\nfunction setPathOptions(path: Element, options: IDrawPathOptions) {\n    const { strokeWidth, stroke, fill, strokeLinecap, close = false } = options;\n    if (fill) path.setAttribute('fill', fill);\n    if (stroke) path.setAttribute('stroke', stroke);\n    if (strokeWidth) path.setAttribute('stroke-width', strokeWidth.toString());\n    if (strokeLinecap) path.setAttribute('stroke-linecap', strokeLinecap);\n    path.setAttribute('close', `${close}`);\n}\n\nfunction findOrCreate(\n    svg: SVGSVGElement | null,\n    key: string | undefined,\n    type: string,\n    groupId?: string,\n) {\n    let element = key ? svg?.getElementById(key) : undefined;\n    const id = key ?? `${IID++}`;\n    if (!element) {\n        element = document.createElementNS(SVG_NS, type);\n        element.setAttribute('id', id);\n        const dest = groupId ? svg?.getElementById(groupId) : svg;\n        dest?.appendChild(element);\n    }\n    return { element, id };\n}\n\nexport function useDrawing(): UseDrawingReturn {\n    const svgRef = useRef<SVGSVGElement>(null);\n\n    useEffect(() => {\n        const svg = svgRef.current!;\n        const parent = svg!.parentElement;\n        const { width, height } = parent!.getBoundingClientRect();\n        svg.setAttribute('viewBox', `0 0 ${width} ${height}`);\n        svg.setAttribute('version', '1.1');\n        svg.setAttribute('xmlns', SVG_NS);\n        svg.setAttribute('width', width.toString());\n        svg.setAttribute('height', height.toString());\n    }, []);\n\n    const drawing: IDrawing = {\n        drawLine: (options) => {\n            const { element, id } = findOrCreate(\n                svgRef.current,\n                options.id,\n                'line',\n                options.groupId,\n            );\n            setLineOptions(element, options);\n            return id;\n        },\n        drawCircle: (options) => {\n            const { element, id } = findOrCreate(\n                svgRef.current,\n                options.id,\n                'ellipse',\n                options.groupId,\n            );\n            setCircleOptions(element, options);\n            return id;\n        },\n        drawRect: (options) => {\n            const { element, id } = findOrCreate(\n                svgRef.current,\n                options.id,\n                'rect',\n                options.groupId,\n            );\n            setRectOptions(element, options);\n            return id;\n        },\n        createGroup: (key, parentId) => {\n            const { id } = findOrCreate(svgRef.current, key, 'g', parentId);\n            return id;\n        },\n        removeElement: (id) => {\n            const element = svgRef.current!.getElementById(id);\n            element.remove();\n        },\n\n        drawPath: (options) => {\n            const { id: key, points, groupId } = options;\n            const { element: path, id } = findOrCreate(svgRef.current, key, 'path', groupId);\n            setPathOptions(path, options);\n            const converter = new Convert();\n            const commands = converter.bezierCurveCommands(points);\n            path.setAttribute('d', commands.map((c) => c.toString()).join(' '));\n            return id;\n        },\n    };\n\n    return {\n        svgRef,\n        drawing,\n    };\n}\n","import React, { Dispatch, SetStateAction, useCallback, useRef, useState } from 'react';\nimport { IDrawing, useDrawing } from '../hooks/useDrawing';\n\nexport type IToolType = 'wall' | 'cursor' | 'move' | 'pencil' | 'eraser';\n\nexport type Point = {\n    x: number;\n    y: number;\n    editId?: number;\n};\n\nexport type Line = {\n    id: number;\n    p1: Point;\n    p2: Point;\n    editId?: number;\n};\n\nexport type IPlan = {\n    walls: Line[];\n};\n\nexport type IGlobalState = {\n    scale: number;\n    selectedTool: IToolType;\n    pointerDown: boolean;\n\n    stylusMode: boolean;\n    magneticMode: boolean;\n    wallAlignmentMode: boolean;\n\n    plan: IPlan;\n};\n\nexport type IGlobalContext = {\n    globalState: IGlobalState;\n    setGlobalState: Dispatch<SetStateAction<IGlobalState>>;\n    updateGlobalState: (state: Partial<IGlobalState>) => void;\n\n    drawing: IDrawing;\n    drawingRef: React.RefObject<SVGSVGElement>;\n    interactiveRef: React.RefObject<HTMLDivElement>;\n};\n\nexport function useGlobalState(): IGlobalContext {\n    const defaultState: Partial<IGlobalState> = {\n        scale: 1,\n        selectedTool: 'wall',\n        pointerDown: false,\n\n        stylusMode: true,\n        magneticMode: true,\n        wallAlignmentMode: true,\n\n        plan: {\n            walls: [],\n        },\n    };\n\n    const [globalState, setGlobalState] = useState<IGlobalState>(defaultState as any);\n\n    const updateGlobalState = useCallback(\n        (update) => setGlobalState((prev) => ({ ...prev, ...update })),\n        [],\n    );\n\n    const interactiveRef = useRef<HTMLDivElement>(null);\n    const { svgRef: drawingRef, drawing } = useDrawing();\n    const context: IGlobalContext = {\n        drawing,\n        drawingRef,\n        interactiveRef,\n\n        globalState,\n        setGlobalState,\n        updateGlobalState,\n    };\n    return context;\n}\n\nexport const GlobalContext = React.createContext<IGlobalContext>(null!);\n\nexport const useGlobalContext = () => {\n    const context = React.useContext<IGlobalContext>(GlobalContext);\n    if (context === null) {\n        throw new Error('useGlobalContext must be used within an GlobalContext.Provider');\n    }\n    return context;\n};\n","import React from 'react';\nimport { useGlobalContext } from '../GlobalContext';\nimport './Settings.css';\n\nexport const Settings: React.FC = () => {\n    const {\n        globalState: { stylusMode, magneticMode, wallAlignmentMode },\n        updateGlobalState,\n    } = useGlobalContext();\n    return (\n        <div className=\"settingsList\">\n            <div>\n                <label>\n                    <input\n                        type=\"checkbox\"\n                        checked={stylusMode ?? false}\n                        onChange={(e) => updateGlobalState({ stylusMode: e.target.checked })}\n                    />\n                    Режим стилуса\n                </label>\n            </div>\n            <div>\n                <label>\n                    <input\n                        type=\"checkbox\"\n                        checked={wallAlignmentMode ?? false}\n                        onChange={(e) => updateGlobalState({ wallAlignmentMode: e.target.checked })}\n                    />\n                    Ровные стены\n                </label>\n            </div>\n\n            <div>\n                <label>\n                    <input\n                        type=\"checkbox\"\n                        checked={magneticMode ?? false}\n                        onChange={(e) => updateGlobalState({ magneticMode: e.target.checked })}\n                    />\n                    Привязка к стенам\n                </label>\n            </div>\n        </div>\n    );\n};\n","import { IDrawing } from '../hooks/useDrawing';\nimport { Line, Point } from './GlobalContext';\n\nexport type DrawEvent = { x: number; y: number; id: number };\n\nexport type DrawPoint = Point & {\n    lineWidth?: number;\n    color?: string;\n};\n\ntype Context = IDrawing;\n\nexport function drawLine(\n    ctx: Context,\n    id: string | undefined,\n    groupId: string | undefined,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n) {\n    ctx.drawLine({ id, groupId, x1, y1, x2, y2 });\n}\nexport function drawSquare(\n    ctx: Context,\n    id: string | undefined,\n    groupId: string | undefined,\n    xc: number,\n    yc: number,\n    size: number,\n    fill?: string,\n) {\n    ctx.drawRect({\n        id,\n        groupId,\n        x: xc - size / 2,\n        y: yc - size / 2,\n        width: size,\n        height: size,\n        fill,\n    });\n}\n\nexport function drawCircle(\n    ctx: Context,\n    id: string | undefined,\n    groupId: string | undefined,\n    xc: number,\n    yc: number,\n    radius: number,\n    fill?: string,\n    stroke?: string,\n) {\n    ctx.drawCircle({ id, groupId, x: xc, y: yc, rx: radius, ry: radius, fill, stroke });\n}\n\nexport const wallPointSize = 10;\nexport const wallCircleRadius = 15;\n\nexport const wallGroupId = (wall: Line) => `w${wall.id}`;\n\nexport function drawWallStart(ctx: Context, wall: Line) {\n    const gid = wallGroupId(wall);\n    drawSquare(ctx, `w${wall.id}s`, gid, wall.p1.x, wall.p1.y, wallPointSize, 'green');\n}\nexport function drawWallEnd(ctx: Context, wall: Line) {\n    const gid = wallGroupId(wall);\n    drawSquare(ctx, `w${wall.id}e`, gid, wall.p2.x, wall.p2.y, wallPointSize, 'red');\n}\n\nexport function drawWall(ctx: Context, wall: Line) {\n    const gid = ctx.createGroup(wallGroupId(wall), 'walls');\n    drawCircle(ctx, `w${wall.id}c1`, gid, wall.p1.x, wall.p1.y, wallCircleRadius, 'none', '#000');\n    drawCircle(ctx, `w${wall.id}c2`, gid, wall.p2.x, wall.p2.y, wallCircleRadius, 'none', '#000');\n    drawLine(ctx, `w${wall.id}l`, gid, wall.p1.x, wall.p1.y, wall.p2.x, wall.p2.y);\n    drawWallStart(ctx, wall);\n    drawWallEnd(ctx, wall);\n}\n","import { Point } from './GlobalContext';\n\nexport type WallOrientation = 'horizontal' | 'vertical';\n\nexport function getWallOrientation({ p1, p2 }: { p1: Point; p2: Point }): WallOrientation {\n    const dx = p2.x - p1.x;\n    const dy = p2.y - p1.y;\n    if (Math.abs(dx) > Math.abs(dy)) {\n        return 'horizontal';\n    }\n    return 'vertical';\n}\n\nexport function distanceBetween(p1: Point, p2: Point): number {\n    return Math.sqrt((p2.x - p1.x) * (p2.x - p1.x) + (p2.y - p1.y) * (p2.y - p1.y));\n}\n","type TypedTouch = Touch & { touchType: 'stylus' | 'direct' };\n\nexport type ToolEvent = {\n    id: number;\n    x: number;\n    y: number;\n\n    type: 'mouse' | 'stylus' | 'touch';\n    buttons?: number;\n    touches?: TypedTouch[];\n    changedTouches?: TypedTouch[];\n};\n\nexport type ToolEventHandler = (e: ToolEvent) => void;\n\nexport function registerTool(\n    element: HTMLElement,\n    onStart: ToolEventHandler,\n    onMove: ToolEventHandler,\n    onEnd: ToolEventHandler,\n) {\n    function mouseToToolEvent(e: MouseEvent): ToolEvent {\n        return {\n            id: 1,\n            x: e.pageX,\n            y: e.pageY,\n            type: 'mouse',\n            buttons: e.buttons,\n            changedTouches: [\n                {\n                    identifier: 1,\n                    pageX: e.pageX,\n                    pageY: e.pageY,\n                } as any as TypedTouch,\n            ],\n        };\n    }\n    const onMouseDown = (e: MouseEvent) => onStart(mouseToToolEvent(e));\n    const onMouseMove = (e: MouseEvent) => onMove(mouseToToolEvent(e));\n    const onMouseUp = (e: MouseEvent) => onEnd(mouseToToolEvent(e));\n\n    function touchToToolEvent(e: TouchEvent): ToolEvent {\n        const touch = e.changedTouches[0] as TypedTouch;\n        return {\n            id: touch.identifier,\n            x: touch.pageX,\n            y: touch.pageY,\n            touches: Array.from(e.touches) as TypedTouch[],\n            changedTouches: Array.from(e.changedTouches) as TypedTouch[],\n            type: touch.touchType === 'stylus' ? 'stylus' : 'touch',\n        };\n    }\n    const onTouchStart = (e: TouchEvent) => onStart(touchToToolEvent(e));\n    const onTouchMove = (e: TouchEvent) => onMove(touchToToolEvent(e));\n    const onTouchEnd = (e: TouchEvent) => onEnd(touchToToolEvent(e));\n\n    element.addEventListener('mousedown', onMouseDown);\n    element.addEventListener('mousemove', onMouseMove);\n    element.addEventListener('mouseup', onMouseUp);\n\n    element.addEventListener('touchstart', onTouchStart);\n    element.addEventListener('touchmove', onTouchMove);\n    element.addEventListener('touchend', onTouchEnd);\n\n    return () => {\n        element.removeEventListener('mousedown', onMouseDown);\n        element.removeEventListener('mousemove', onMouseMove);\n        element.removeEventListener('mouseup', onMouseUp);\n\n        element.removeEventListener('touchstart', onTouchStart);\n        element.removeEventListener('touchmove', onTouchMove);\n        element.removeEventListener('touchend', onTouchEnd);\n    };\n}\n","import React, { useEffect } from 'react';\nimport { drawWall, wallCircleRadius } from '../Draw';\nimport { distanceBetween } from '../Geometry';\nimport { useGlobalContext } from '../GlobalContext';\nimport { registerTool, ToolEvent } from './ToolEvent';\n\nexport const CursorTool: React.FC = () => {\n    const { interactiveRef, drawing, globalState, updateGlobalState } = useGlobalContext();\n    const { scale, stylusMode, magneticMode, selectedTool, plan } = globalState;\n\n    useEffect(() => {\n        if (!interactiveRef.current || selectedTool !== 'cursor') {\n            return;\n        }\n\n        const onStart = (e: ToolEvent) => {\n            if (stylusMode && e.type === 'touch') return;\n            updateGlobalState({ pointerDown: true });\n            e.changedTouches?.forEach((touch) => {\n                const id = touch.identifier;\n                const x = touch.pageX * scale;\n                const y = touch.pageY * scale;\n                plan.walls\n                    .flatMap((item) => [item.p1, item.p2])\n                    .filter((p) => distanceBetween(p, { x, y }) <= wallCircleRadius)\n                    .forEach((p) => {\n                        p.editId = id;\n                    });\n            });\n        };\n\n        const onMove = (e: ToolEvent) => {\n            if (e.type === 'mouse' && !e.buttons) return;\n            e.changedTouches?.forEach((touch) => {\n                const id = touch.identifier;\n                const x = touch.pageX * scale;\n                const y = touch.pageY * scale;\n                plan.walls\n                    .flatMap((w) => [w.p1, w.p2])\n                    .filter((p) => p.editId === id)\n                    .forEach((p) => {\n                        p.x = x;\n                        p.y = y;\n                    });\n                plan.walls\n                    .filter((w) => w.p1.editId || w.p2.editId)\n                    .forEach((w) => drawWall(drawing, w));\n            });\n        };\n\n        const onEnd = (e: ToolEvent) => {\n            e.changedTouches?.forEach((touch) => {\n                const id = touch.identifier;\n                plan.walls\n                    .flatMap((item) => [item.p1, item.p2])\n                    .filter((x) => x.editId === id)\n                    .forEach((p) => {\n                        p.editId = undefined;\n                        if (magneticMode) {\n                            const closePoint = plan.walls\n                                .flatMap((item) => [item.p1, item.p2])\n                                .filter((o) => o !== p && o.x !== p.x && o.y !== p.y)\n                                .find((o) => distanceBetween(o, p) <= wallCircleRadius);\n\n                            if (closePoint) {\n                                p.x = closePoint.x;\n                                p.y = closePoint.y;\n                            }\n                        }\n                    });\n            });\n            if (e.touches?.length === 0) {\n                updateGlobalState({ pointerDown: false });\n            }\n        };\n\n        return registerTool(interactiveRef.current, onStart, onMove, onEnd);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [interactiveRef.current, scale, stylusMode, magneticMode, selectedTool]);\n\n    return null;\n};\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCursor(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCursor);\nexport default __webpack_public_path__ + \"static/media/cursor.d5e3bd0c.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect } from 'react';\nimport { DrawPoint } from '../Draw';\nimport { IToolType, useGlobalContext } from '../GlobalContext';\nimport { registerTool, ToolEvent } from './ToolEvent';\n\nconst tools: IToolType[] = ['pencil', 'eraser'];\n\nexport const PenTool: React.FC = () => {\n    const { drawing, interactiveRef, globalState, updateGlobalState } = useGlobalContext();\n    const { scale, stylusMode, magneticMode, selectedTool } = globalState;\n\n    useEffect(() => {\n        if (!interactiveRef.current || !tools.includes(selectedTool)) {\n            return;\n        }\n\n        let lineWidth = 1;\n        let points: DrawPoint[] = [];\n        let id: string | undefined;\n\n        const onStart = (e: ToolEvent) => {\n            if (stylusMode && e.type === 'touch') return;\n            if (e.type === 'touch' && e.touches!.length > 1) return;\n            updateGlobalState({ pointerDown: true });\n            const touch = e.touches && e.touches[0];\n            const x = (touch?.pageX ?? e.x) * scale;\n            const y = (touch?.pageY ?? e.y) * scale;\n            lineWidth = Math.log((touch?.force || 0.1) + 1) * 10;\n            if (selectedTool === 'pencil') {\n                points.push({ x, y, lineWidth });\n                id = drawing.drawPath({\n                    points,\n                    stroke: '#000',\n                    strokeWidth: lineWidth,\n                    fill: 'none',\n                    groupId: 'pen',\n                });\n            } else {\n                id = drawing.drawPath({\n                    points,\n                    stroke: '#000',\n                    strokeLinecap: 'round',\n                    strokeWidth: lineWidth * 20,\n                    fill: 'none',\n                    groupId: 'eraser',\n                });\n            }\n        };\n\n        const onMove = (e: ToolEvent) => {\n            if (stylusMode && e.type === 'touch') return;\n            if (e.type === 'mouse' && !e.buttons) return;\n            const touch = e.touches && e.touches[0];\n            const x = (touch?.pageX ?? e.x) * scale;\n            const y = (touch?.pageY ?? e.y) * scale;\n            lineWidth = Math.log((touch?.force || 0.1) + 1) * 40 * 0.2 + (lineWidth ?? 1) * 0.8;\n            points!.push({ x, y, lineWidth });\n            drawing.drawPath({ id, points });\n        };\n\n        const onEnd = (e: ToolEvent) => {\n            points = [];\n            lineWidth = 0;\n            if (!e.touches || e.touches.length === 0) {\n                updateGlobalState({ pointerDown: false });\n            }\n        };\n\n        return registerTool(interactiveRef.current, onStart, onMove, onEnd);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [interactiveRef.current, scale, stylusMode, magneticMode, selectedTool]);\n\n    return null;\n};\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgEraser(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgEraser);\nexport default __webpack_public_path__ + \"static/media/eraser.e5d177cd.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgPencil(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgPencil);\nexport default __webpack_public_path__ + \"static/media/pencil.a3ff265f.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgWall(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgWall);\nexport default __webpack_public_path__ + \"static/media/wall.87ac9ec5.svg\";\nexport { ForwardRef as ReactComponent };","import clsx from 'clsx';\nimport React from 'react';\nimport { ReactComponent as CursorIcon } from '../../assets/icons/cursor.svg';\nimport { ReactComponent as EraserIcon } from '../../assets/icons/eraser.svg';\nimport { ReactComponent as PencilIcon } from '../../assets/icons/pencil.svg';\nimport { ReactComponent as WallIcon } from '../../assets/icons/wall.svg';\n// import { ReactComponent as MoveIcon } from '../../assets/icons/move.svg';\nimport { IToolType, useGlobalContext } from '../GlobalContext';\nimport './Toolbox.css';\n\ntype IToolboxProps = {};\n\nexport const Toolbox: React.FC<IToolboxProps> = () => {\n    const {\n        globalState: { selectedTool },\n        updateGlobalState,\n    } = useGlobalContext();\n\n    const setSelectedTool = (tool: IToolType) => {\n        updateGlobalState({ selectedTool: tool });\n    };\n\n    type IToolVoxItemProps = {\n        type: IToolType;\n        name: string;\n        icon?: JSX.Element;\n    };\n    const ToolBoxItem: React.FC<IToolVoxItemProps> = ({ type, name, icon }) => {\n        return (\n            <div\n                onClick={() => setSelectedTool(type)}\n                className={clsx('toolboxItem', selectedTool === type && 'toolboxSelectedItem')}\n            >\n                {icon ?? name}\n            </div>\n        );\n    };\n\n    return (\n        <div className=\"toolboxContainer\">\n            <ToolBoxItem type=\"wall\" name=\"Стена\" icon={<WallIcon />} />\n            <ToolBoxItem type=\"cursor\" name=\"Курсор\" icon={<CursorIcon />} />\n            <ToolBoxItem type=\"pencil\" name=\"Карандаш\" icon={<PencilIcon />} />\n            <ToolBoxItem type=\"eraser\" name=\"Ластик\" icon={<EraserIcon />} />\n        </div>\n    );\n};\n","import React, { useEffect } from 'react';\nimport { drawWall, drawWallEnd, drawWallStart, wallCircleRadius, wallGroupId } from '../Draw';\nimport { distanceBetween, getWallOrientation } from '../Geometry';\nimport { Line, useGlobalContext } from '../GlobalContext';\nimport { registerTool, ToolEvent } from './ToolEvent';\n\nlet IID = 0;\n\nexport const WallTool: React.FC = () => {\n    const { interactiveRef, drawing, globalState, updateGlobalState } = useGlobalContext();\n    const { scale, stylusMode, magneticMode, wallAlignmentMode, selectedTool, plan } = globalState;\n\n    useEffect(() => {\n        if (!interactiveRef.current || selectedTool !== 'wall') {\n            return;\n        }\n\n        const redrawEditingLines = () => {\n            plan.walls\n                .filter((x) => x.editId)\n                .forEach((wall) => {\n                    drawWall(drawing, wall);\n                });\n        };\n\n        const cancel = (id: number) => {\n            const wallIndex = plan.walls.findIndex((x) => x.editId === id);\n            if (wallIndex >= 0) {\n                const walls = plan.walls.splice(wallIndex, 1);\n                drawing.removeElement(wallGroupId(walls[0]));\n                redrawEditingLines();\n            }\n        };\n\n        const onStart = (e: ToolEvent) => {\n            console.log('wall onStart', e);\n            const x = e.x * scale;\n            const y = e.y * scale;\n            if (stylusMode && e.type === 'touch') return;\n            if (e.type === 'touch' && e.touches!.length > 1) {\n                cancel(e.id);\n                return;\n            }\n            updateGlobalState({ pointerDown: true }); // TODO: это вызывает полный ререндер\n            const wall: Line = {\n                id: IID++,\n                editId: e.id,\n                p1: { x, y },\n                p2: { x, y },\n            };\n            if (magneticMode) {\n                const closePoint = plan.walls\n                    .flatMap((item) => [item.p1, item.p2])\n                    .find((p) => distanceBetween(p, wall.p1) <= wallCircleRadius);\n\n                if (closePoint) {\n                    wall.p1.x = closePoint.x;\n                    wall.p1.y = closePoint.y;\n                    wall.p2.x = closePoint.x;\n                    wall.p2.y = closePoint.y;\n                }\n            }\n            plan.walls.push(wall);\n            drawWallStart(drawing, wall);\n        };\n\n        const onMove = (e: ToolEvent) => {\n            if (e.type === 'mouse' && !e.buttons) return;\n            const x = e.x * scale;\n            const y = e.y * scale;\n            const wall = plan.walls.find((x) => x.editId === e.id);\n            if (wall) {\n                wall.p2.x = x;\n                wall.p2.y = y;\n                if (wallAlignmentMode) {\n                    if (getWallOrientation({ p1: wall.p1, p2: { x, y } }) === 'horizontal') {\n                        wall.p2.y = wall.p1.y;\n                    } else {\n                        wall.p2.x = wall.p1.x;\n                    }\n                }\n                redrawEditingLines();\n            }\n        };\n\n        const onEnd = (e: ToolEvent) => {\n            console.log('wall onEnd', e);\n            const { id, touches } = e;\n            const wall = plan.walls.find((x) => x.editId === id);\n            if (wall) {\n                wall.editId = undefined;\n                if (magneticMode) {\n                    const closePoint = plan.walls\n                        .filter((w) => w !== wall)\n                        .flatMap((item) => [item.p1, item.p2])\n                        .find((p) => distanceBetween(p, wall.p2) <= wallCircleRadius);\n\n                    if (closePoint) {\n                        wall.p2.x = closePoint.x;\n                        wall.p2.y = closePoint.y;\n                    }\n                }\n                redrawEditingLines();\n                drawWallEnd(drawing, wall);\n                drawWall(drawing, wall);\n            }\n            if (touches?.length === 0) {\n                updateGlobalState({ pointerDown: false }); // TODO: это вызывает полный ререндер\n            }\n        };\n\n        return registerTool(interactiveRef.current, onStart, onMove, onEnd);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [interactiveRef.current, stylusMode, magneticMode, wallAlignmentMode, selectedTool]);\n\n    return null;\n};\n","import React, { useEffect } from 'react';\nimport { Helmet } from 'react-helmet';\nimport './App.css';\nimport { GlobalContext, useGlobalState } from './components/GlobalContext';\nimport { Settings } from './components/Settings/Settings';\nimport { CursorTool } from './components/Tools/CursorTool';\nimport { PenTool } from './components/Tools/PenTool';\nimport { Toolbox } from './components/Tools/Toolbox';\nimport { WallTool } from './components/Tools/WallTool';\n\nfunction App() {\n    const globalContext = useGlobalState();\n    const { drawingRef, interactiveRef, globalState } = globalContext;\n    const { pointerDown } = globalState;\n\n    useEffect(() => {\n        const onTouchMove = (e: TouchEvent) => {\n            if (pointerDown) {\n                e.preventDefault();\n            }\n        };\n        document.addEventListener('touchmove', onTouchMove, { passive: false });\n        return () => {\n            document.removeEventListener('touchmove', onTouchMove);\n        };\n    }, [pointerDown]);\n\n    return (\n        <GlobalContext.Provider value={globalContext}>\n            <>\n                <Helmet>\n                    <title>Measure App</title>\n                </Helmet>\n                <main>\n                    <WallTool />\n                    <CursorTool />\n                    <PenTool />\n                    <div ref={interactiveRef} className=\"paper main\">\n                        <svg ref={drawingRef}>\n                            <mask id=\"eraser\">\n                                <rect width=\"100%\" height=\"100%\" fill=\"#fff\" />\n                            </mask>\n                            <g id=\"walls\" />\n                            <g id=\"pen\" mask=\"url(#eraser)\" />\n                        </svg>\n                    </div>\n                    <Toolbox />\n                    <Settings />\n                </main>\n            </>\n        </GlobalContext.Provider>\n    );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}