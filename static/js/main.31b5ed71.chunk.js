(this["webpackJsonpmeasure-app"]=this["webpackJsonpmeasure-app"]||[]).push([[0],{20:function(t,e,n){},24:function(t,e,n){},25:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(11),u=n.n(o),l=(n(20),n(12)),c=(n(24),n(10)),a=n(7),s=n(9),d=n(3),f=n(4),h=function(){function t(e,n){Object(d.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=n}return Object(f.a)(t,[{key:"toVector",value:function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)),e=Math.atan2(this.y,this.x);return new w(t,e)}},{key:"scale",value:function(e){return new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"eql",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"clone",value:function(){return new t(this.x,this.y)}}]),t}(),v="M",p="L",g="C",y="Z",b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(d.a)(this,t),this.type=void 0,this.value=void 0,this.value=n,this.type=e}return Object(f.a)(t,[{key:"cr",get:function(){if(("C"===this.type||"c"===this.type)&&6===this.value.length){var t=this.value.slice(2,4),e=Object(a.a)(t,2),n=e[0],r=e[1];return new h(n,r)}},set:function(t){t&&("C"!==this.type&&"c"!==this.type||6!==this.value.length||(this.value.splice(2,1,t.x),this.value.splice(3,1,t.y)))}},{key:"cl",get:function(){if(("C"===this.type||"c"===this.type)&&6===this.value.length){var t=this.value.slice(0,2),e=Object(a.a)(t,2),n=e[0],r=e[1];return new h(n,r)}},set:function(t){t&&("C"!==this.type&&"c"!==this.type||6!==this.value.length||(this.value.splice(0,1,t.x),this.value.splice(1,1,t.y)))}},{key:"point",get:function(){var t=this.value.slice(this.value.length-2);return 2===t.length?new h(t[0],t[1]):void 0},set:function(t){t&&(this.value.splice(this.value.length-2,1,t.x),this.value.splice(this.value.length-1,1,t.y))}},{key:"toString",value:function(){return this.type===y?y:"".concat(this.type," ").concat(this.value.map((function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return+t.toFixed(e)}(t)})).join(" "))}},{key:"scale",value:function(e){return new t(this.type,this.value.map((function(t){return t*e})))}},{key:"clone",value:function(){return new t(this.type,this.value.slice())}}]),t}(),w=function(){function t(e,n){Object(d.a)(this,t),this.angle=void 0,this.value=void 0,this.value=e,this.angle=n}return Object(f.a)(t,[{key:"toPoint",value:function(){var t=Math.cos(this.angle)*this.value,e=Math.sin(this.angle)*this.value;return new h(t,e)}},{key:"scale",value:function(e){return new t(this.value*e,this.angle)}}]),t}(),x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ratio;Object(d.a)(this,t),this.ratio=void 0,this.ratio=null!==n&&void 0!==n?n:.2}return Object(f.a)(t,[{key:"_controlPoint",value:function(t,e,n){var r=new h(t.x,t.y),i=new h(e.x,e.y),o=new h(n.x,n.y).sub(r).toVector().scale(this.ratio).toPoint(),u=i.add(o);return[u.x,u.y]}},{key:"bezierCurve",value:function(t,e,n,r){var i=[].concat(Object(s.a)(this._controlPoint(t,e,n)),Object(s.a)(this._controlPoint(r,n,e)),[n.x,n.y]);return new b(g,i)}},{key:"lineCommands",value:function(t){return t.map((function(t,e){return new b(0===e?v:p,[t.x,t.y])}))}},{key:"bezierCurveCommands",value:function(t){var e=[];if(t.length<3)return this.lineCommands(t);for(var n=0;n<t.length;n+=1)0!==n?e.push(this.bezierCurve(t[n-2<0?0:n-2],t[n-1],t[n],n<t.length-1?t[n+1]:t[n])):e.push(new b(v,[t[n].x,t[n].y]));return e}}]),t}(),j="http://www.w3.org/2000/svg",m=0;function O(t,e,n,r){var i=e?null===t||void 0===t?void 0:t.getElementById(e):void 0,o=null!==e&&void 0!==e?e:"".concat(m++);if(!i){(i=document.createElementNS(j,n)).setAttribute("id",o);var u=r?null===t||void 0===t?void 0:t.getElementById(r):t;null===u||void 0===u||u.appendChild(i)}return{element:i,id:o}}function k(){var t=Object(r.useState)({scale:1,selectedTool:"wall",pointerDown:!1,stylusMode:!0,magneticMode:!0,wallAlignmentMode:!0,plan:{walls:[]}}),e=Object(a.a)(t,2),n=e[0],i=e[1],o=Object(r.useCallback)((function(t){return i((function(e){return Object(c.a)(Object(c.a)({},e),t)}))}),[]),u=Object(r.useRef)(null),l=function(){var t=Object(r.useRef)(null);Object(r.useEffect)((function(){var e=t.current,n=e.parentElement.getBoundingClientRect(),r=n.width,i=n.height;e.setAttribute("viewBox","0 0 ".concat(r," ").concat(i)),e.setAttribute("version","1.1"),e.setAttribute("xmlns",j),e.setAttribute("width",r.toString()),e.setAttribute("height",i.toString())}),[]);var e={drawLine:function(e){var n=O(t.current,e.id,"line",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x1,r=e.x2,i=e.y1,o=e.y2,u=e.strokeWidth,l=e.stroke,c=void 0===l?"#000":l;t.setAttribute("x1",n.toString()),t.setAttribute("y1",i.toString()),t.setAttribute("x2",r.toString()),t.setAttribute("y2",o.toString()),t.setAttribute("stroke",c),u&&t.setAttribute("stroke-width",u.toString())}(r,e),i},drawCircle:function(e){var n=O(t.current,e.id,"ellipse",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x,r=e.y,i=e.rx,o=e.ry,u=e.strokeWidth,l=e.stroke,c=e.fill;t.setAttribute("cx",n.toString()),t.setAttribute("cy",r.toString()),t.setAttribute("rx",i.toString()),t.setAttribute("ry",o.toString()),c&&t.setAttribute("fill",c),l&&t.setAttribute("stroke",l),u&&t.setAttribute("stroke-width",u.toString())}(r,e),i},drawRect:function(e){var n=O(t.current,e.id,"rect",e.groupId),r=n.element,i=n.id;return function(t,e){var n=e.x,r=e.y,i=e.width,o=e.height,u=e.strokeWidth,l=e.stroke,c=e.fill;t.setAttribute("x",n.toString()),t.setAttribute("y",r.toString()),t.setAttribute("width",i.toString()),t.setAttribute("height",o.toString()),c&&t.setAttribute("fill",c),l&&t.setAttribute("stroke",l),u&&t.setAttribute("stroke-width",u.toString())}(r,e),i},createGroup:function(e,n){return O(t.current,e,"g",n).id},removeElement:function(e){t.current.getElementById(e).remove()},drawPath:function(e){var n=e.id,r=e.points,i=e.groupId,o=O(t.current,n,"path",i),u=o.element,l=o.id;!function(t,e){var n=e.strokeWidth,r=e.stroke,i=e.fill,o=e.strokeLinecap,u=e.close,l=void 0!==u&&u;i&&t.setAttribute("fill",i),r&&t.setAttribute("stroke",r),n&&t.setAttribute("stroke-width",n.toString()),o&&t.setAttribute("stroke-linecap",o),t.setAttribute("close","".concat(l))}(u,e);var c=(new x).bezierCurveCommands(r);return u.setAttribute("d",c.map((function(t){return t.toString()})).join(" ")),l}};return{svgRef:t,drawing:e}}(),s=l.svgRef;return{drawing:l.drawing,drawingRef:s,interactiveRef:u,globalState:n,setGlobalState:i,updateGlobalState:o}}var E=i.a.createContext(null),M=function(){var t=i.a.useContext(E);if(null===t)throw new Error("useGlobalContext must be used within an GlobalContext.Provider");return t},S=(n(25),n(1)),C=function(){var t=M(),e=t.globalState,n=e.stylusMode,r=e.magneticMode,i=e.wallAlignmentMode,o=t.updateGlobalState;return Object(S.jsxs)("div",{className:"settingsList",children:[Object(S.jsx)("div",{children:Object(S.jsxs)("label",{children:[Object(S.jsx)("input",{type:"checkbox",checked:null!==n&&void 0!==n&&n,onChange:function(t){return o({stylusMode:t.target.checked})}}),"\u0420\u0435\u0436\u0438\u043c \u0441\u0442\u0438\u043b\u0443\u0441\u0430"]})}),Object(S.jsx)("div",{children:Object(S.jsxs)("label",{children:[Object(S.jsx)("input",{type:"checkbox",checked:null!==i&&void 0!==i&&i,onChange:function(t){return o({wallAlignmentMode:t.target.checked})}}),"\u0420\u043e\u0432\u043d\u044b\u0435 \u0441\u0442\u0435\u043d\u044b"]})}),Object(S.jsx)("div",{children:Object(S.jsxs)("label",{children:[Object(S.jsx)("input",{type:"checkbox",checked:null!==r&&void 0!==r&&r,onChange:function(t){return o({magneticMode:t.target.checked})}}),"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u043a \u0441\u0442\u0435\u043d\u0430\u043c"]})})]})};function L(t,e,n,r,i,o,u){t.drawRect({id:e,groupId:n,x:r-o/2,y:i-o/2,width:o,height:o,fill:u})}function A(t,e,n,r,i,o,u,l){t.drawCircle({id:e,groupId:n,x:r,y:i,rx:o,ry:o,fill:u,stroke:l})}var I=15,P=function(t){return"w".concat(t.id)};function R(t,e){var n=P(e);L(t,"w".concat(e.id,"s"),n,e.p1.x,e.p1.y,10,"green")}function V(t,e){var n=P(e);L(t,"w".concat(e.id,"e"),n,e.p2.x,e.p2.y,10,"red")}function T(t,e){var n=t.createGroup(P(e),"walls");A(t,"w".concat(e.id,"c1"),n,e.p1.x,e.p1.y,I,"none","#000"),A(t,"w".concat(e.id,"c2"),n,e.p2.x,e.p2.y,I,"none","#000"),function(t,e,n,r,i,o,u){t.drawLine({id:e,groupId:n,x1:r,y1:i,x2:o,y2:u})}(t,"w".concat(e.id,"l"),n,e.p1.x,e.p1.y,e.p2.x,e.p2.y),R(t,e),V(t,e)}function H(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function X(t,e,n,r){function i(t){return{id:1,x:t.pageX,y:t.pageY,type:"mouse",buttons:t.buttons,changedTouches:[{identifier:1,pageX:t.pageX,pageY:t.pageY}]}}var o=function(t){return e(i(t))},u=function(t){return n(i(t))},l=function(t){return r(i(t))};function c(t){var e=t.changedTouches[0];return{id:e.identifier,x:e.pageX,y:e.pageY,touches:Array.from(t.touches),changedTouches:Array.from(t.changedTouches),type:"stylus"===e.touchType?"stylus":"touch"}}var a=function(t){return e(c(t))},s=function(t){return n(c(t))},d=function(t){return r(c(t))};return t.addEventListener("mousedown",o),t.addEventListener("mousemove",u),t.addEventListener("mouseup",l),t.addEventListener("touchstart",a),t.addEventListener("touchmove",s),t.addEventListener("touchend",d),function(){t.removeEventListener("mousedown",o),t.removeEventListener("mousemove",u),t.removeEventListener("mouseup",l),t.removeEventListener("touchstart",a),t.removeEventListener("touchmove",s),t.removeEventListener("touchend",d)}}var B,G=function(){var t=M(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,u=i.scale,l=i.stylusMode,c=i.magneticMode,a=i.selectedTool,s=i.plan;return Object(r.useEffect)((function(){if(e.current&&"cursor"===a){return X(e.current,(function(t){var e;l&&"touch"===t.type||(o({pointerDown:!0}),null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,n=t.pageX*u,r=t.pageY*u;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return H(t,{x:n,y:r})<=I})).forEach((function(t){t.editId=e}))})))}),(function(t){var e;("mouse"!==t.type||t.buttons)&&(null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier,r=t.pageX*u,i=t.pageY*u;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){t.x=r,t.y=i})),s.walls.filter((function(t){return t.p1.editId||t.p2.editId})).forEach((function(t){return T(n,t)}))})))}),(function(t){var e,n;null===(e=t.changedTouches)||void 0===e||e.forEach((function(t){var e=t.identifier;s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(t){return t.editId===e})).forEach((function(t){if(t.editId=void 0,c){var e=s.walls.flatMap((function(t){return[t.p1,t.p2]})).filter((function(e){return e!==t&&e.x!==t.x&&e.y!==t.y})).find((function(e){return H(e,t)<=I}));e&&(t.x=e.x,t.y=e.y)}}))})),0===(null===(n=t.touches)||void 0===n?void 0:n.length)&&o({pointerDown:!1})}))}}),[e.current,u,l,c,a]),null},D=["pencil","eraser"],W=function(){var t=M(),e=t.drawing,n=t.interactiveRef,i=t.globalState,o=t.updateGlobalState,u=i.scale,l=i.stylusMode,c=i.magneticMode,a=i.selectedTool;return Object(r.useEffect)((function(){if(n.current&&D.includes(a)){var t,r=1,i=[];return X(n.current,(function(n){var c,s;if((!l||"touch"!==n.type)&&!("touch"===n.type&&n.touches.length>1)){o({pointerDown:!0});var d=n.touches&&n.touches[0],f=(null!==(c=null===d||void 0===d?void 0:d.pageX)&&void 0!==c?c:n.x)*u,h=(null!==(s=null===d||void 0===d?void 0:d.pageY)&&void 0!==s?s:n.y)*u;r=10*Math.log(((null===d||void 0===d?void 0:d.force)||.1)+1),"pencil"===a?(i.push({x:f,y:h,lineWidth:r}),t=e.drawPath({points:i,stroke:"#000",strokeWidth:r,fill:"none",groupId:"pen"})):t=e.drawPath({points:i,stroke:"#000",strokeLinecap:"round",strokeWidth:20*r,fill:"none",groupId:"eraser"})}}),(function(n){var o,c,a;if((!l||"touch"!==n.type)&&("mouse"!==n.type||n.buttons)){var s=n.touches&&n.touches[0],d=(null!==(o=null===s||void 0===s?void 0:s.pageX)&&void 0!==o?o:n.x)*u,f=(null!==(c=null===s||void 0===s?void 0:s.pageY)&&void 0!==c?c:n.y)*u;r=40*Math.log(((null===s||void 0===s?void 0:s.force)||.1)+1)*.2+.8*(null!==(a=r)&&void 0!==a?a:1),i.push({x:d,y:f,lineWidth:r}),e.drawPath({id:t,points:i})}}),(function(t){i=[],r=0,t.touches&&0!==t.touches.length||o({pointerDown:!1})}))}}),[n.current,u,l,c,a]),null},Y=n(15),z=["title","titleId"];function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function N(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Z(t,e){var n=t.title,i=t.titleId,o=N(t,z);return r.createElement("svg",F({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,B||(B=r.createElement("path",{d:"M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})))}var q,_=r.forwardRef(Z),J=(n.p,["title","titleId"]);function K(){return(K=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Q(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function U(t,e){var n=t.title,i=t.titleId,o=Q(t,J);return r.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,q||(q=r.createElement("path",{d:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"})))}var $,tt=r.forwardRef(U),et=(n.p,["title","titleId"]);function nt(){return(nt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function rt(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function it(t,e){var n=t.title,i=t.titleId,o=rt(t,et);return r.createElement("svg",nt({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,$||($=r.createElement("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})))}var ot,ut=r.forwardRef(it),lt=(n.p,["title","titleId"]);function ct(){return(ct=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function at(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function st(t,e){var n=t.title,i=t.titleId,o=at(t,lt);return r.createElement("svg",ct({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:24,height:24,viewBox:"0 0 24 24",ref:e,"aria-labelledby":i},o),n?r.createElement("title",{id:i},n):null,ot||(ot=r.createElement("path",{d:"M3,16H12V21H3V16M2,10H8V15H2V10M9,10H15V15H9V10M16,10H22V15H16V10M13,16H21V21H13V16M3,4H11V9H3V4M12,4H21V9H12V4Z"})))}var dt=r.forwardRef(st),ft=(n.p,n(27),function(){var t=M(),e=t.globalState.selectedTool,n=t.updateGlobalState,r=function(t){var r=t.type,i=t.name,o=t.icon;return Object(S.jsx)("div",{onClick:function(){n({selectedTool:r})},className:Object(Y.a)("toolboxItem",e===r&&"toolboxSelectedItem"),children:null!==o&&void 0!==o?o:i})};return Object(S.jsxs)("div",{className:"toolboxContainer",children:[Object(S.jsx)(r,{type:"wall",name:"\u0421\u0442\u0435\u043d\u0430",icon:Object(S.jsx)(dt,{})}),Object(S.jsx)(r,{type:"cursor",name:"\u041a\u0443\u0440\u0441\u043e\u0440",icon:Object(S.jsx)(_,{})}),Object(S.jsx)(r,{type:"pencil",name:"\u041a\u0430\u0440\u0430\u043d\u0434\u0430\u0448",icon:Object(S.jsx)(ut,{})}),Object(S.jsx)(r,{type:"eraser",name:"\u041b\u0430\u0441\u0442\u0438\u043a",icon:Object(S.jsx)(tt,{})})]})}),ht=0,vt=function(){var t=M(),e=t.interactiveRef,n=t.drawing,i=t.globalState,o=t.updateGlobalState,u=i.scale,l=i.stylusMode,c=i.magneticMode,a=i.wallAlignmentMode,s=i.selectedTool,d=i.plan;return Object(r.useEffect)((function(){if(e.current&&"wall"===s){var t=function(){d.walls.filter((function(t){return t.editId})).forEach((function(t){T(n,t)}))};return X(e.current,(function(e){console.log("wall onStart",e);var r=e.x*u,i=e.y*u;if(!l||"touch"!==e.type)if("touch"===e.type&&e.touches.length>1)!function(e){var r=d.walls.findIndex((function(t){return t.editId===e}));if(r>=0){var i=d.walls.splice(r,1);n.removeElement(P(i[0])),t()}}(e.id);else{o({pointerDown:!0});var a={id:ht++,editId:e.id,p1:{x:r,y:i},p2:{x:r,y:i}};if(c){var s=d.walls.flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return H(t,a.p1)<=I}));s&&(a.p1.x=s.x,a.p1.y=s.y,a.p2.x=s.x,a.p2.y=s.y)}d.walls.push(a),R(n,a)}}),(function(e){if("mouse"!==e.type||e.buttons){var n=e.x*u,r=e.y*u,i=d.walls.find((function(t){return t.editId===e.id}));i&&(i.p2.x=n,i.p2.y=r,a&&("horizontal"===function(t){var e=t.p1,n=t.p2,r=n.x-e.x,i=n.y-e.y;return Math.abs(r)>Math.abs(i)?"horizontal":"vertical"}({p1:i.p1,p2:{x:n,y:r}})?i.p2.y=i.p1.y:i.p2.x=i.p1.x),t())}}),(function(e){console.log("wall onEnd",e);var r=e.id,i=e.touches,u=d.walls.find((function(t){return t.editId===r}));if(u){if(u.editId=void 0,c){var l=d.walls.filter((function(t){return t!==u})).flatMap((function(t){return[t.p1,t.p2]})).find((function(t){return H(t,u.p2)<=I}));l&&(u.p2.x=l.x,u.p2.y=l.y)}t(),V(n,u),T(n,u)}0===(null===i||void 0===i?void 0:i.length)&&o({pointerDown:!1})}))}}),[e.current,l,c,a,s]),null};var pt=function(){var t=k(),e=t.drawingRef,n=t.interactiveRef,i=t.globalState.pointerDown;return Object(r.useEffect)((function(){var t=function(t){i&&t.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),function(){document.removeEventListener("touchmove",t)}}),[i]),Object(S.jsx)(E.Provider,{value:t,children:Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(l.a,{children:Object(S.jsx)("title",{children:"Measure App"})}),Object(S.jsxs)("main",{children:[Object(S.jsx)(vt,{}),Object(S.jsx)(G,{}),Object(S.jsx)(W,{}),Object(S.jsx)("div",{ref:n,className:"paper main",children:Object(S.jsxs)("svg",{ref:e,children:[Object(S.jsx)("mask",{id:"eraser",children:Object(S.jsx)("rect",{width:"100%",height:"100%",fill:"#fff"})}),Object(S.jsx)("g",{id:"walls"}),Object(S.jsx)("g",{id:"pen",mask:"url(#eraser)"})]})}),Object(S.jsx)(ft,{}),Object(S.jsx)(C,{})]})]})})},gt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,u=e.getTTFB;n(t),r(t),i(t),o(t),u(t)}))};u.a.render(Object(S.jsx)(i.a.StrictMode,{children:Object(S.jsx)(pt,{})}),document.getElementById("root")),gt()}},[[28,1,2]]]);
//# sourceMappingURL=main.31b5ed71.chunk.js.map